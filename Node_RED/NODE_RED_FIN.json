[
    {
        "id": "d43d9cbcc461780f",
        "type": "tab",
        "label": "Flow 2",
        "disabled": false,
        "info": ""
    },
    {
        "id": "93b73ac1f3ffd401",
        "type": "ui_slider",
        "z": "d43d9cbcc461780f",
        "name": "",
        "label": "Nivel de Luz",
        "tooltip": "",
        "group": "ab327fe76cd1459c",
        "order": 1,
        "width": 0,
        "height": 0,
        "passthru": true,
        "outs": "end",
        "topic": "",
        "topicType": "str",
        "min": 0,
        "max": "100",
        "step": 1,
        "className": "",
        "x": 250,
        "y": 3120,
        "wires": [
            [
                "82584b0981ae855d",
                "166ed5e9248335ee"
            ]
        ]
    },
    {
        "id": "3f1e0154c4989b80",
        "type": "mqtt in",
        "z": "d43d9cbcc461780f",
        "name": "",
        "topic": "II1/ESP3098241/datos",
        "qos": "2",
        "datatype": "auto",
        "broker": "819581010d48bfd0",
        "nl": false,
        "rap": true,
        "rh": 0,
        "x": 280,
        "y": 640,
        "wires": [
            [
                "a16f7bf7b7d0a606"
            ]
        ]
    },
    {
        "id": "a16f7bf7b7d0a606",
        "type": "json",
        "z": "d43d9cbcc461780f",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 490,
        "y": 640,
        "wires": [
            [
                "19b7da173da916e2",
                "e96a851990046965",
                "c204a635e6123cb7",
                "ffdebc6e0d081336",
                "eef53446774f96b4",
                "f4ad83968289086a",
                "d4c0219da7118c9f",
                "6f14303ec0a9534b",
                "e33319129b0f4e5f",
                "4ec0f4212f49b6a8",
                "4a5e0924d22af9d8",
                "ec243fdc392be9b2"
            ]
        ]
    },
    {
        "id": "19b7da173da916e2",
        "type": "change",
        "z": "d43d9cbcc461780f",
        "name": "TEMPERATURA",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.DHT11.temp",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "Temperatura",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 700,
        "y": 820,
        "wires": [
            [
                "4b7b2c6c782fe724",
                "8459c8e2f8c9faab"
            ]
        ]
    },
    {
        "id": "e96a851990046965",
        "type": "change",
        "z": "d43d9cbcc461780f",
        "name": "HUMEDAD",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.DHT11.hum",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "Humedad",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 690,
        "y": 920,
        "wires": [
            [
                "17be8d4b0077e063",
                "589d2bf4b18516f6"
            ]
        ]
    },
    {
        "id": "c204a635e6123cb7",
        "type": "change",
        "z": "d43d9cbcc461780f",
        "name": "LED",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.LED",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "LED",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 670,
        "y": 1000,
        "wires": [
            [
                "24af90c76dae4fec"
            ]
        ]
    },
    {
        "id": "89ea32e59448e6bd",
        "type": "function",
        "z": "d43d9cbcc461780f",
        "name": "formato hora",
        "func": "// cambiamos el payload que recibimos (timestamp) por la fecha/hora formateada en texto...\nvar fecha = new Date(msg.payload);\nmsg.payload = fecha.toLocaleString(\"es-ES\",{\"timeZone\":\"Europe/Madrid\"});\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 910,
        "y": 640,
        "wires": [
            [
                "66d9f7d92645fcec"
            ]
        ]
    },
    {
        "id": "0dfbcde1975a3abd",
        "type": "ui_text_input",
        "z": "d43d9cbcc461780f",
        "name": "envia",
        "label": "envia",
        "tooltip": "",
        "group": "8c10952216336c2b",
        "order": 1,
        "width": 0,
        "height": 0,
        "passthru": true,
        "mode": "number",
        "delay": "0",
        "topic": "topic",
        "sendOnBlur": true,
        "topicType": "msg",
        "x": 230,
        "y": 2600,
        "wires": [
            [
                "586e6acf902370ab"
            ]
        ]
    },
    {
        "id": "1be6a099d7c3a417",
        "type": "ui_text_input",
        "z": "d43d9cbcc461780f",
        "name": "actualiza",
        "label": "actualiza",
        "tooltip": "",
        "group": "8c10952216336c2b",
        "order": 2,
        "width": 0,
        "height": 0,
        "passthru": true,
        "mode": "number",
        "delay": "0",
        "topic": "topic",
        "sendOnBlur": true,
        "topicType": "msg",
        "x": 240,
        "y": 2640,
        "wires": [
            [
                "5d0b8e11cdc3d14f"
            ]
        ]
    },
    {
        "id": "641dfec0319c6ff3",
        "type": "ui_text_input",
        "z": "d43d9cbcc461780f",
        "name": "velocidad",
        "label": "velocidad",
        "tooltip": "",
        "group": "8c10952216336c2b",
        "order": 3,
        "width": 0,
        "height": 0,
        "passthru": true,
        "mode": "number",
        "delay": "0",
        "topic": "topic",
        "sendOnBlur": true,
        "topicType": "msg",
        "x": 240,
        "y": 2680,
        "wires": [
            [
                "165c5446d050bb3f"
            ]
        ]
    },
    {
        "id": "fda7a5983dd6eb6f",
        "type": "comment",
        "z": "d43d9cbcc461780f",
        "name": "CONFIG      Topic: IIX/ESPX/config",
        "info": "",
        "x": 250,
        "y": 2540,
        "wires": []
    },
    {
        "id": "4a7292ed8df82253",
        "type": "ui_switch",
        "z": "d43d9cbcc461780f",
        "name": "",
        "label": "switch",
        "tooltip": "",
        "group": "8c10952216336c2b",
        "order": 5,
        "width": 0,
        "height": 0,
        "passthru": true,
        "decouple": "false",
        "topic": "topic",
        "topicType": "msg",
        "style": "",
        "onvalue": "2",
        "onvalueType": "num",
        "onicon": "",
        "oncolor": "",
        "offvalue": "1",
        "offvalueType": "num",
        "officon": "",
        "offcolor": "",
        "animate": false,
        "className": "",
        "x": 230,
        "y": 2760,
        "wires": [
            [
                "82adaf094310d246"
            ]
        ]
    },
    {
        "id": "1e1f2f5b499d7423",
        "type": "comment",
        "z": "d43d9cbcc461780f",
        "name": "ACTUADORES    Topic: IIX/ESPX/led/cmd",
        "info": "",
        "x": 280,
        "y": 3060,
        "wires": []
    },
    {
        "id": "25c9a268d01cc6ee",
        "type": "ui_dropdown",
        "z": "d43d9cbcc461780f",
        "name": "",
        "label": "SELECT ESP",
        "tooltip": "",
        "place": "seleccione un ESP",
        "group": "ab327fe76cd1459c",
        "order": 3,
        "width": 0,
        "height": 0,
        "passthru": true,
        "multiple": false,
        "options": [
            {
                "label": "ESP1_cris",
                "value": "3098241",
                "type": "str"
            },
            {
                "label": "ESP2_hugo",
                "value": "9745759",
                "type": "str"
            },
            {
                "label": "ESP3_javi",
                "value": "10796726",
                "type": "str"
            },
            {
                "label": "ESP4_julian",
                "value": "1128666",
                "type": "str"
            }
        ],
        "payload": "",
        "topic": "id_ESP_led",
        "topicType": "flow",
        "className": "",
        "x": 260,
        "y": 3240,
        "wires": [
            [
                "d1b8562dbe6ff2f9"
            ]
        ]
    },
    {
        "id": "749c587d54105c25",
        "type": "ui_dropdown",
        "z": "d43d9cbcc461780f",
        "name": "LED",
        "label": "LED",
        "tooltip": "",
        "place": "Select option",
        "group": "8c10952216336c2b",
        "order": 4,
        "width": 0,
        "height": 0,
        "passthru": true,
        "multiple": false,
        "options": [
            {
                "label": "ENCENDIDO",
                "value": 2,
                "type": "num"
            },
            {
                "label": "APAGADO",
                "value": 1,
                "type": "num"
            }
        ],
        "payload": "",
        "topic": "topic",
        "topicType": "msg",
        "className": "LED",
        "x": 230,
        "y": 2720,
        "wires": [
            [
                "0285e6bd16e8826a"
            ]
        ]
    },
    {
        "id": "82584b0981ae855d",
        "type": "ui_text",
        "z": "d43d9cbcc461780f",
        "group": "ab327fe76cd1459c",
        "order": 2,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Nivel de Luz seleccionado:",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 460,
        "y": 3160,
        "wires": []
    },
    {
        "id": "63b762765b29e3c3",
        "type": "debug",
        "z": "d43d9cbcc461780f",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 1110,
        "y": 2740,
        "wires": []
    },
    {
        "id": "7a42f7d35c0487ce",
        "type": "function",
        "z": "d43d9cbcc461780f",
        "name": "Payload JSON y TOPIC enviar",
        "func": "var envia=flow.get(\"envia\") || null; //valor por defecto (5minutos)\nvar actualiza=flow.get(\"actualiza\") || null;\nvar velocidad=flow.get(\"velocidad\") || null;\nvar LED=flow.get(\"LED\") || null;\nvar SWITCH=flow.get(\"SWITCH\") || null;\n\nvar id_ESP=flow.get(\"id_ESP_config\");\n\nmsg.payload={\"envia\":envia, \"actualiza\":actualiza, \"velocidad\":velocidad,\"LED\":LED,\"SWITCH\":SWITCH};\n\nmsg.topic=\"II1/ESP\"+id_ESP+\"/config\";\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 890,
        "y": 2680,
        "wires": [
            [
                "94e94625a1fc61e4",
                "63b762765b29e3c3"
            ]
        ]
    },
    {
        "id": "0c4b997c7e299396",
        "type": "ui_button",
        "z": "d43d9cbcc461780f",
        "name": "",
        "group": "8c10952216336c2b",
        "order": 7,
        "width": 0,
        "height": 0,
        "passthru": false,
        "label": "Botón",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "",
        "payload": "",
        "payloadType": "str",
        "topic": "topic",
        "topicType": "msg",
        "x": 670,
        "y": 2680,
        "wires": [
            [
                "7a42f7d35c0487ce"
            ]
        ]
    },
    {
        "id": "586e6acf902370ab",
        "type": "change",
        "z": "d43d9cbcc461780f",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "envia",
                "pt": "flow",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 420,
        "y": 2600,
        "wires": [
            []
        ]
    },
    {
        "id": "5d0b8e11cdc3d14f",
        "type": "change",
        "z": "d43d9cbcc461780f",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "actualiza",
                "pt": "flow",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 430,
        "y": 2640,
        "wires": [
            []
        ]
    },
    {
        "id": "165c5446d050bb3f",
        "type": "change",
        "z": "d43d9cbcc461780f",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "velocidad",
                "pt": "flow",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 430,
        "y": 2680,
        "wires": [
            []
        ]
    },
    {
        "id": "0285e6bd16e8826a",
        "type": "change",
        "z": "d43d9cbcc461780f",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "LED",
                "pt": "flow",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 410,
        "y": 2720,
        "wires": [
            []
        ]
    },
    {
        "id": "82adaf094310d246",
        "type": "change",
        "z": "d43d9cbcc461780f",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "SWITCH",
                "pt": "flow",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 430,
        "y": 2760,
        "wires": [
            []
        ]
    },
    {
        "id": "3fd6a1d01b6a500c",
        "type": "comment",
        "z": "d43d9cbcc461780f",
        "name": "0=null; 1=0(apagado); 2=1(encendido)",
        "info": "",
        "x": 650,
        "y": 2720,
        "wires": []
    },
    {
        "id": "465d7608aa345c18",
        "type": "comment",
        "z": "d43d9cbcc461780f",
        "name": "0=null; 1=0(apagado); 2=1(encendido)",
        "info": "",
        "x": 690,
        "y": 2760,
        "wires": []
    },
    {
        "id": "94e94625a1fc61e4",
        "type": "mqtt out",
        "z": "d43d9cbcc461780f",
        "name": "",
        "topic": "",
        "qos": "",
        "retain": "",
        "respTopic": "",
        "contentType": "",
        "userProps": "",
        "correl": "",
        "expiry": "",
        "broker": "819581010d48bfd0",
        "x": 1150,
        "y": 2680,
        "wires": []
    },
    {
        "id": "4ba0120f3ad07e12",
        "type": "function",
        "z": "d43d9cbcc461780f",
        "name": "Payload JSON y TOPIC enviar",
        "func": "var NivelLED=flow.get(\"NivelLED\");\nvar idESP=flow.get(\"id_ESP_led\");\n\nmsg.payload={\"level\":NivelLED};\nmsg.topic=\"II1/ESP\"+idESP+\"/led/cmd\";\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 890,
        "y": 3180,
        "wires": [
            [
                "59f5030f72c4fcd4",
                "8ad3bbdc0a269f93"
            ]
        ]
    },
    {
        "id": "ffdebc6e0d081336",
        "type": "change",
        "z": "d43d9cbcc461780f",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "",
                "tot": "date"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 710,
        "y": 640,
        "wires": [
            [
                "89ea32e59448e6bd"
            ]
        ]
    },
    {
        "id": "3e1454d2f1016a43",
        "type": "comment",
        "z": "d43d9cbcc461780f",
        "name": "ACTUALIZACION     Topic: IIX/ESPX/datos",
        "info": "",
        "x": 280,
        "y": 520,
        "wires": []
    },
    {
        "id": "66d9f7d92645fcec",
        "type": "ui_text",
        "z": "d43d9cbcc461780f",
        "group": "cc1d7259111dc549",
        "order": 2,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "FECHA DE ÚLTIMA ACTUALIZACIÓN (CRIS)",
        "format": "{{msg.payload}}",
        "layout": "col-center",
        "className": "",
        "x": 1200,
        "y": 640,
        "wires": []
    },
    {
        "id": "4b7b2c6c782fe724",
        "type": "ui_gauge",
        "z": "d43d9cbcc461780f",
        "name": "",
        "group": "cc1d7259111dc549",
        "order": 5,
        "width": 0,
        "height": 0,
        "gtype": "gage",
        "title": "Temperatura",
        "label": "ºC",
        "format": "{{value}}",
        "min": "10",
        "max": "45",
        "colors": [
            "#ff0000",
            "#00ff00",
            "#ff0000"
        ],
        "seg1": "15",
        "seg2": "40",
        "className": "",
        "x": 930,
        "y": 860,
        "wires": []
    },
    {
        "id": "17be8d4b0077e063",
        "type": "ui_gauge",
        "z": "d43d9cbcc461780f",
        "name": "",
        "group": "cc1d7259111dc549",
        "order": 6,
        "width": 0,
        "height": 0,
        "gtype": "gage",
        "title": "Humedad",
        "label": "%",
        "format": "{{value}}",
        "min": "0",
        "max": "100",
        "colors": [
            "#ff0000",
            "#00ff00",
            "#ff0000"
        ],
        "seg1": "20",
        "seg2": "80",
        "className": "",
        "x": 920,
        "y": 960,
        "wires": []
    },
    {
        "id": "24af90c76dae4fec",
        "type": "ui_text",
        "z": "d43d9cbcc461780f",
        "group": "cc1d7259111dc549",
        "order": 7,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Valor nivel led:",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 860,
        "y": 1000,
        "wires": []
    },
    {
        "id": "e10fceb81e7d0dbe",
        "type": "comment",
        "z": "d43d9cbcc461780f",
        "name": "CRIS: ESP3098241",
        "info": "{\n    \"group\":{\n        \"hide\":[]\n    }\n}",
        "x": 310,
        "y": 580,
        "wires": []
    },
    {
        "id": "c44efc40ae24ec86",
        "type": "comment",
        "z": "d43d9cbcc461780f",
        "name": "HUGO: ESP9745759",
        "info": "",
        "x": 320,
        "y": 1420,
        "wires": []
    },
    {
        "id": "61d26e5348e59fca",
        "type": "comment",
        "z": "d43d9cbcc461780f",
        "name": "JAVI: ESP10796726",
        "info": "",
        "x": 1660,
        "y": 580,
        "wires": []
    },
    {
        "id": "815bc7b2531a11c0",
        "type": "comment",
        "z": "d43d9cbcc461780f",
        "name": "JULIAN: ESP1128666",
        "info": "",
        "x": 1660,
        "y": 1440,
        "wires": []
    },
    {
        "id": "eef53446774f96b4",
        "type": "change",
        "z": "d43d9cbcc461780f",
        "name": "Uptime",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.Uptime",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "Uptime",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 680,
        "y": 700,
        "wires": [
            [
                "f1760e0e18465371"
            ]
        ]
    },
    {
        "id": "f4ad83968289086a",
        "type": "change",
        "z": "d43d9cbcc461780f",
        "name": "Vcc",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.Vcc",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "Vcc",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 670,
        "y": 760,
        "wires": [
            [
                "cdf07c4aa3fcb941"
            ]
        ]
    },
    {
        "id": "f1760e0e18465371",
        "type": "ui_text",
        "z": "d43d9cbcc461780f",
        "group": "cc1d7259111dc549",
        "order": 3,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Uptime: ",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 880,
        "y": 700,
        "wires": []
    },
    {
        "id": "cdf07c4aa3fcb941",
        "type": "ui_text",
        "z": "d43d9cbcc461780f",
        "group": "cc1d7259111dc549",
        "order": 4,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Vcc: ",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 870,
        "y": 760,
        "wires": []
    },
    {
        "id": "d4c0219da7118c9f",
        "type": "change",
        "z": "d43d9cbcc461780f",
        "name": "SWITCH",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.SWITCH",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "SWITCH",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 680,
        "y": 1060,
        "wires": [
            [
                "ce8d2b1262a10ae3"
            ]
        ]
    },
    {
        "id": "ce8d2b1262a10ae3",
        "type": "ui_text",
        "z": "d43d9cbcc461780f",
        "group": "cc1d7259111dc549",
        "order": 9,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Switch: ",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 840,
        "y": 1060,
        "wires": []
    },
    {
        "id": "46caa08a3c7d5d2a",
        "type": "mqtt in",
        "z": "d43d9cbcc461780f",
        "name": "",
        "topic": "II1/ESP9745759/datos",
        "qos": "2",
        "datatype": "auto",
        "broker": "819581010d48bfd0",
        "nl": false,
        "rap": true,
        "rh": 0,
        "x": 280,
        "y": 1480,
        "wires": [
            [
                "d9f51a270d7fe585"
            ]
        ]
    },
    {
        "id": "d9f51a270d7fe585",
        "type": "json",
        "z": "d43d9cbcc461780f",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 490,
        "y": 1480,
        "wires": [
            [
                "e2742e68f7155dba",
                "60979f5b5a504dd3",
                "b553fdfa35c30ca5",
                "8c4ef245fa5e43bc",
                "9a330f0924f33fea",
                "cb439a5aec9d63e2",
                "aa4c6b44b0793aa0",
                "f64886c0e542cf2d",
                "1c3598374dbebc39",
                "d28a02528ea09b79",
                "3f6f035bcc51e361",
                "6e1a7af203180627"
            ]
        ]
    },
    {
        "id": "8c4ef245fa5e43bc",
        "type": "debug",
        "z": "d43d9cbcc461780f",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 690,
        "y": 1360,
        "wires": []
    },
    {
        "id": "e2742e68f7155dba",
        "type": "change",
        "z": "d43d9cbcc461780f",
        "name": "TEMPERATURA",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.DHT11.temp",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "Temperatura",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 700,
        "y": 1660,
        "wires": [
            [
                "8afc31559b68e2e4",
                "573a7cd38cd79eef"
            ]
        ]
    },
    {
        "id": "60979f5b5a504dd3",
        "type": "change",
        "z": "d43d9cbcc461780f",
        "name": "HUMEDAD",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.DHT11.hum",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "Humedad",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 690,
        "y": 1760,
        "wires": [
            [
                "c428c4cee4e55f30",
                "14557f2b51804d43"
            ]
        ]
    },
    {
        "id": "b553fdfa35c30ca5",
        "type": "change",
        "z": "d43d9cbcc461780f",
        "name": "LED",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.LED",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "LED",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 670,
        "y": 1840,
        "wires": [
            [
                "177b924fd367b530"
            ]
        ]
    },
    {
        "id": "177b924fd367b530",
        "type": "ui_text",
        "z": "d43d9cbcc461780f",
        "group": "8bc36ba409dbee33",
        "order": 7,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Valor nivel led:",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 860,
        "y": 1840,
        "wires": []
    },
    {
        "id": "9a330f0924f33fea",
        "type": "change",
        "z": "d43d9cbcc461780f",
        "name": "Uptime",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.Uptime",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "Uptime",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 680,
        "y": 1540,
        "wires": [
            [
                "7232df5706dd6ce7"
            ]
        ]
    },
    {
        "id": "cb439a5aec9d63e2",
        "type": "change",
        "z": "d43d9cbcc461780f",
        "name": "Vcc",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.Vcc",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "Vcc",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 670,
        "y": 1600,
        "wires": [
            [
                "8fba552b3325e1fd"
            ]
        ]
    },
    {
        "id": "7232df5706dd6ce7",
        "type": "ui_text",
        "z": "d43d9cbcc461780f",
        "group": "8bc36ba409dbee33",
        "order": 3,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Uptime: ",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 880,
        "y": 1540,
        "wires": []
    },
    {
        "id": "8fba552b3325e1fd",
        "type": "ui_text",
        "z": "d43d9cbcc461780f",
        "group": "8bc36ba409dbee33",
        "order": 4,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Vcc: ",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 870,
        "y": 1600,
        "wires": []
    },
    {
        "id": "aa4c6b44b0793aa0",
        "type": "change",
        "z": "d43d9cbcc461780f",
        "name": "SWITCH",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.SWITCH",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "SWITCH",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 680,
        "y": 1900,
        "wires": [
            [
                "0fa211fb3b661f71"
            ]
        ]
    },
    {
        "id": "0fa211fb3b661f71",
        "type": "ui_text",
        "z": "d43d9cbcc461780f",
        "group": "8bc36ba409dbee33",
        "order": 9,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Switch: ",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 840,
        "y": 1900,
        "wires": []
    },
    {
        "id": "cea58daea3345e21",
        "type": "mqtt in",
        "z": "d43d9cbcc461780f",
        "name": "",
        "topic": "II1/ESP10796726/datos",
        "qos": "2",
        "datatype": "auto",
        "broker": "819581010d48bfd0",
        "nl": false,
        "rap": true,
        "rh": 0,
        "x": 1630,
        "y": 640,
        "wires": [
            [
                "4c16e4dd876e99ec"
            ]
        ]
    },
    {
        "id": "4c16e4dd876e99ec",
        "type": "json",
        "z": "d43d9cbcc461780f",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 1830,
        "y": 640,
        "wires": [
            [
                "44968c6c64208eb1",
                "567637652d7e7225",
                "490bb4fbdc1dc2e5",
                "6b239d912fe7a077",
                "3299fcb07ec2d14a",
                "ea6603a4b17d1450",
                "0c0d38bc0999ee2f",
                "aa41798614eda3f8",
                "1212e15a561f59d8",
                "3318f89c0ab9de94",
                "ab70f6a5aa9b82d8",
                "75bc7d9f2e69c361"
            ]
        ]
    },
    {
        "id": "6b239d912fe7a077",
        "type": "debug",
        "z": "d43d9cbcc461780f",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 2030,
        "y": 500,
        "wires": []
    },
    {
        "id": "44968c6c64208eb1",
        "type": "change",
        "z": "d43d9cbcc461780f",
        "name": "TEMPERATURA",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.DHT11.temp",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "Temperatura",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 2040,
        "y": 800,
        "wires": [
            [
                "87a98efc327b0ebc",
                "30e113a0603d93db"
            ]
        ]
    },
    {
        "id": "567637652d7e7225",
        "type": "change",
        "z": "d43d9cbcc461780f",
        "name": "HUMEDAD",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.DHT11.hum",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "Humedad",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 2030,
        "y": 900,
        "wires": [
            [
                "19a72187fe12fa9e",
                "1f35ba7f818e9e45"
            ]
        ]
    },
    {
        "id": "490bb4fbdc1dc2e5",
        "type": "change",
        "z": "d43d9cbcc461780f",
        "name": "LED",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.LED",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "LED",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 2010,
        "y": 1000,
        "wires": [
            [
                "d736a73519199dee"
            ]
        ]
    },
    {
        "id": "d736a73519199dee",
        "type": "ui_text",
        "z": "d43d9cbcc461780f",
        "group": "a65ec6fec0e4c4fc",
        "order": 7,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Valor nivel led:",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 2200,
        "y": 1000,
        "wires": []
    },
    {
        "id": "3299fcb07ec2d14a",
        "type": "change",
        "z": "d43d9cbcc461780f",
        "name": "Uptime",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.Uptime",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "Uptime",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 2020,
        "y": 680,
        "wires": [
            [
                "c0f2773c94f725da"
            ]
        ]
    },
    {
        "id": "ea6603a4b17d1450",
        "type": "change",
        "z": "d43d9cbcc461780f",
        "name": "Vcc",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.Vcc",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "Vcc",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 2010,
        "y": 740,
        "wires": [
            [
                "6129030ce61ae083"
            ]
        ]
    },
    {
        "id": "c0f2773c94f725da",
        "type": "ui_text",
        "z": "d43d9cbcc461780f",
        "group": "a65ec6fec0e4c4fc",
        "order": 3,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Uptime: ",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 2220,
        "y": 680,
        "wires": []
    },
    {
        "id": "6129030ce61ae083",
        "type": "ui_text",
        "z": "d43d9cbcc461780f",
        "group": "a65ec6fec0e4c4fc",
        "order": 4,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Vcc: ",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 2210,
        "y": 740,
        "wires": []
    },
    {
        "id": "0c0d38bc0999ee2f",
        "type": "change",
        "z": "d43d9cbcc461780f",
        "name": "SWITCH",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.SWITCH",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "SWITCH",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 2020,
        "y": 1060,
        "wires": [
            [
                "6806cf66618bf6a2"
            ]
        ]
    },
    {
        "id": "6806cf66618bf6a2",
        "type": "ui_text",
        "z": "d43d9cbcc461780f",
        "group": "a65ec6fec0e4c4fc",
        "order": 9,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Switch: ",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 2180,
        "y": 1060,
        "wires": []
    },
    {
        "id": "ce2185a8bf422fd0",
        "type": "mqtt in",
        "z": "d43d9cbcc461780f",
        "name": "",
        "topic": "II1/ESP1128666/datos",
        "qos": "2",
        "datatype": "auto",
        "broker": "819581010d48bfd0",
        "nl": false,
        "rap": true,
        "rh": 0,
        "x": 1620,
        "y": 1500,
        "wires": [
            [
                "808f4ab276a43075"
            ]
        ]
    },
    {
        "id": "808f4ab276a43075",
        "type": "json",
        "z": "d43d9cbcc461780f",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 1830,
        "y": 1500,
        "wires": [
            [
                "277877b67a497b01",
                "3814cae8c863ef42",
                "2aa3d261b6716c0d",
                "0e719c324325e926",
                "bb4f73581279f50c",
                "1a9a6496f60e8168",
                "dcbb38f2c935fa9a",
                "af7a44278f7e4872",
                "a97c0730ee56bb70",
                "8af42a7a91bd63bf",
                "70c13592025310c8",
                "3499c96f9d8adfc6"
            ]
        ]
    },
    {
        "id": "0e719c324325e926",
        "type": "debug",
        "z": "d43d9cbcc461780f",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 2030,
        "y": 1380,
        "wires": []
    },
    {
        "id": "277877b67a497b01",
        "type": "change",
        "z": "d43d9cbcc461780f",
        "name": "TEMPERATURA",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.DHT11.temp",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "Temperatura",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 2040,
        "y": 1680,
        "wires": [
            [
                "bcd9d72ce6ec8138",
                "80fd7cefce34f8cc"
            ]
        ]
    },
    {
        "id": "3814cae8c863ef42",
        "type": "change",
        "z": "d43d9cbcc461780f",
        "name": "HUMEDAD",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.DHT11.hum",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "Humedad",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 2030,
        "y": 1780,
        "wires": [
            [
                "b3c2dd4cb984f4f7",
                "a2d3b489f945157a"
            ]
        ]
    },
    {
        "id": "2aa3d261b6716c0d",
        "type": "change",
        "z": "d43d9cbcc461780f",
        "name": "LED",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.LED",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "LED",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 2010,
        "y": 1880,
        "wires": [
            [
                "a289a53415850f06"
            ]
        ]
    },
    {
        "id": "a289a53415850f06",
        "type": "ui_text",
        "z": "d43d9cbcc461780f",
        "group": "5709fd4619421f28",
        "order": 7,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Valor nivel led:",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 2200,
        "y": 1880,
        "wires": []
    },
    {
        "id": "bb4f73581279f50c",
        "type": "change",
        "z": "d43d9cbcc461780f",
        "name": "Uptime",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.Uptime",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "Uptime",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 2020,
        "y": 1560,
        "wires": [
            [
                "19ae629b4e76875b"
            ]
        ]
    },
    {
        "id": "1a9a6496f60e8168",
        "type": "change",
        "z": "d43d9cbcc461780f",
        "name": "Vcc",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.Vcc",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "Vcc",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 2010,
        "y": 1620,
        "wires": [
            [
                "0df316e9f3126e25"
            ]
        ]
    },
    {
        "id": "19ae629b4e76875b",
        "type": "ui_text",
        "z": "d43d9cbcc461780f",
        "group": "5709fd4619421f28",
        "order": 3,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Uptime: ",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 2220,
        "y": 1560,
        "wires": []
    },
    {
        "id": "0df316e9f3126e25",
        "type": "ui_text",
        "z": "d43d9cbcc461780f",
        "group": "5709fd4619421f28",
        "order": 4,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Vcc: ",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 2210,
        "y": 1620,
        "wires": []
    },
    {
        "id": "dcbb38f2c935fa9a",
        "type": "change",
        "z": "d43d9cbcc461780f",
        "name": "SWITCH",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.SWITCH",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "SWITCH",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 2020,
        "y": 1940,
        "wires": [
            [
                "5f903e1936d41c3f"
            ]
        ]
    },
    {
        "id": "5f903e1936d41c3f",
        "type": "ui_text",
        "z": "d43d9cbcc461780f",
        "group": "5709fd4619421f28",
        "order": 9,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Switch: ",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 2180,
        "y": 1940,
        "wires": []
    },
    {
        "id": "6f14303ec0a9534b",
        "type": "change",
        "z": "d43d9cbcc461780f",
        "name": "CHIPID (ESP)",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.CHIPID",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "ESP",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 700,
        "y": 580,
        "wires": [
            [
                "22c638a4b7d3c528"
            ]
        ]
    },
    {
        "id": "22c638a4b7d3c528",
        "type": "ui_text",
        "z": "d43d9cbcc461780f",
        "group": "cc1d7259111dc549",
        "order": 1,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Última actualización del ESP:",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 970,
        "y": 580,
        "wires": []
    },
    {
        "id": "f64886c0e542cf2d",
        "type": "change",
        "z": "d43d9cbcc461780f",
        "name": "CHIPID (ESP)",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.CHIPID",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "ESP",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 700,
        "y": 1420,
        "wires": [
            [
                "a05c4a25e419fd75"
            ]
        ]
    },
    {
        "id": "a05c4a25e419fd75",
        "type": "ui_text",
        "z": "d43d9cbcc461780f",
        "group": "8bc36ba409dbee33",
        "order": 1,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Última actualización del ESP:",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 970,
        "y": 1420,
        "wires": []
    },
    {
        "id": "7c696eba90411ee4",
        "type": "function",
        "z": "d43d9cbcc461780f",
        "name": "formato hora",
        "func": "// cambiamos el payload que recibimos (timestamp) por la fecha/hora formateada en texto...\nvar fecha = new Date(msg.payload);\nmsg.payload = fecha.toLocaleString(\"es-ES\",{\"timeZone\":\"Europe/Madrid\"});\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 910,
        "y": 1480,
        "wires": [
            [
                "3becb74564ad697a"
            ]
        ]
    },
    {
        "id": "1c3598374dbebc39",
        "type": "change",
        "z": "d43d9cbcc461780f",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "",
                "tot": "date"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 710,
        "y": 1480,
        "wires": [
            [
                "7c696eba90411ee4"
            ]
        ]
    },
    {
        "id": "3becb74564ad697a",
        "type": "ui_text",
        "z": "d43d9cbcc461780f",
        "group": "8bc36ba409dbee33",
        "order": 2,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "FECHA DE ÚLTIMA ACTUALIZACIÓN (HUGO)",
        "format": "{{msg.payload}}",
        "layout": "col-center",
        "className": "",
        "x": 1200,
        "y": 1480,
        "wires": []
    },
    {
        "id": "af7a44278f7e4872",
        "type": "change",
        "z": "d43d9cbcc461780f",
        "name": "CHIPID (ESP)",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.CHIPID",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "ESP",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 2040,
        "y": 1440,
        "wires": [
            [
                "d9af6a446547df3e"
            ]
        ]
    },
    {
        "id": "d9af6a446547df3e",
        "type": "ui_text",
        "z": "d43d9cbcc461780f",
        "group": "5709fd4619421f28",
        "order": 1,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Última actualización del ESP:",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 2310,
        "y": 1440,
        "wires": []
    },
    {
        "id": "ebe8b7a9362487b9",
        "type": "function",
        "z": "d43d9cbcc461780f",
        "name": "formato hora",
        "func": "// cambiamos el payload que recibimos (timestamp) por la fecha/hora formateada en texto...\nvar fecha = new Date(msg.payload);\nmsg.payload = fecha.toLocaleString(\"es-ES\",{\"timeZone\":\"Europe/Madrid\"});\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 2250,
        "y": 1500,
        "wires": [
            [
                "e6e0cf9a8780d001"
            ]
        ]
    },
    {
        "id": "a97c0730ee56bb70",
        "type": "change",
        "z": "d43d9cbcc461780f",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "",
                "tot": "date"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 2050,
        "y": 1500,
        "wires": [
            [
                "ebe8b7a9362487b9"
            ]
        ]
    },
    {
        "id": "e6e0cf9a8780d001",
        "type": "ui_text",
        "z": "d43d9cbcc461780f",
        "group": "5709fd4619421f28",
        "order": 2,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "FECHA DE ÚLTIMA ACTUALIZACIÓN (JULIAN)",
        "format": "{{msg.payload}}",
        "layout": "col-center",
        "className": "",
        "x": 2570,
        "y": 1500,
        "wires": []
    },
    {
        "id": "aa41798614eda3f8",
        "type": "change",
        "z": "d43d9cbcc461780f",
        "name": "CHIPID (ESP)",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.CHIPID",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "ESP",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 2040,
        "y": 560,
        "wires": [
            [
                "fa89e40f571c8124"
            ]
        ]
    },
    {
        "id": "fa89e40f571c8124",
        "type": "ui_text",
        "z": "d43d9cbcc461780f",
        "group": "a65ec6fec0e4c4fc",
        "order": 1,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Última actualización del ESP:",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 2310,
        "y": 560,
        "wires": []
    },
    {
        "id": "609814b84a15a59a",
        "type": "function",
        "z": "d43d9cbcc461780f",
        "name": "formato hora",
        "func": "// cambiamos el payload que recibimos (timestamp) por la fecha/hora formateada en texto...\nvar fecha = new Date(msg.payload);\nmsg.payload = fecha.toLocaleString(\"es-ES\",{\"timeZone\":\"Europe/Madrid\"});\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 2250,
        "y": 620,
        "wires": [
            [
                "fca329d0638cc1f0"
            ]
        ]
    },
    {
        "id": "1212e15a561f59d8",
        "type": "change",
        "z": "d43d9cbcc461780f",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "",
                "tot": "date"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 2050,
        "y": 620,
        "wires": [
            [
                "609814b84a15a59a"
            ]
        ]
    },
    {
        "id": "fca329d0638cc1f0",
        "type": "ui_text",
        "z": "d43d9cbcc461780f",
        "group": "a65ec6fec0e4c4fc",
        "order": 2,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "FECHA DE ÚLTIMA ACTUALIZACIÓN (JAVI)",
        "format": "{{msg.payload}}",
        "layout": "col-center",
        "className": "",
        "x": 2540,
        "y": 620,
        "wires": []
    },
    {
        "id": "6ea34f3937129f0a",
        "type": "ui_dropdown",
        "z": "d43d9cbcc461780f",
        "name": "idESP",
        "label": "SELECT ESP",
        "tooltip": "",
        "place": "seleccione un ESP",
        "group": "8c10952216336c2b",
        "order": 6,
        "width": 0,
        "height": 0,
        "passthru": true,
        "multiple": false,
        "options": [
            {
                "label": "ESP1_cris",
                "value": 3098241,
                "type": "num"
            },
            {
                "label": "ESP2_hugo",
                "value": 9745759,
                "type": "num"
            },
            {
                "label": "ESP3_javi",
                "value": 10796726,
                "type": "num"
            },
            {
                "label": "ESP4_julian",
                "value": 1128666,
                "type": "num"
            }
        ],
        "payload": "",
        "topic": "",
        "topicType": "str",
        "className": "",
        "x": 230,
        "y": 2800,
        "wires": [
            [
                "3ec0cdf5f442a5bd"
            ]
        ]
    },
    {
        "id": "baa4aa3822901ca5",
        "type": "ui_button",
        "z": "d43d9cbcc461780f",
        "name": "",
        "group": "ab327fe76cd1459c",
        "order": 3,
        "width": 0,
        "height": 0,
        "passthru": false,
        "label": "Botón",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "",
        "payload": "",
        "payloadType": "str",
        "topic": "topic",
        "topicType": "msg",
        "x": 670,
        "y": 3180,
        "wires": [
            [
                "4ba0120f3ad07e12"
            ]
        ]
    },
    {
        "id": "e824c164c1d892af",
        "type": "ui_text_input",
        "z": "d43d9cbcc461780f",
        "name": "",
        "label": "MAX temperatura",
        "tooltip": "",
        "group": "b7a35e9169b8724c",
        "order": 4,
        "width": 0,
        "height": 0,
        "passthru": true,
        "mode": "number",
        "delay": "0",
        "topic": "max_temp",
        "sendOnBlur": true,
        "topicType": "flow",
        "x": 330,
        "y": 2860,
        "wires": [
            [
                "eb95f464705b6232"
            ]
        ]
    },
    {
        "id": "b99509ac6322f4f8",
        "type": "ui_text_input",
        "z": "d43d9cbcc461780f",
        "name": "",
        "label": "MIN temperatura",
        "tooltip": "",
        "group": "b7a35e9169b8724c",
        "order": 4,
        "width": 0,
        "height": 0,
        "passthru": true,
        "mode": "number",
        "delay": "0",
        "topic": "min_temp",
        "sendOnBlur": true,
        "topicType": "flow",
        "x": 330,
        "y": 2900,
        "wires": [
            [
                "ad8cd17a6ed45596"
            ]
        ]
    },
    {
        "id": "e1dfb7d45d7d6243",
        "type": "ui_text_input",
        "z": "d43d9cbcc461780f",
        "name": "",
        "label": "MAX humedad (%)",
        "tooltip": "",
        "group": "b7a35e9169b8724c",
        "order": 4,
        "width": 0,
        "height": 0,
        "passthru": true,
        "mode": "number",
        "delay": "0",
        "topic": "max_hum",
        "sendOnBlur": true,
        "topicType": "flow",
        "x": 330,
        "y": 2940,
        "wires": [
            [
                "8a3b27ae2727f083"
            ]
        ]
    },
    {
        "id": "6eb1fa5fd5a5d2b5",
        "type": "ui_text_input",
        "z": "d43d9cbcc461780f",
        "name": "",
        "label": "MIN humedad (%)",
        "tooltip": "",
        "group": "b7a35e9169b8724c",
        "order": 4,
        "width": 0,
        "height": 0,
        "passthru": true,
        "mode": "number",
        "delay": "0",
        "topic": "min_hum",
        "sendOnBlur": true,
        "topicType": "flow",
        "x": 330,
        "y": 2980,
        "wires": [
            [
                "2828346050d1cf6d"
            ]
        ]
    },
    {
        "id": "4925371207bb0eed",
        "type": "comment",
        "z": "d43d9cbcc461780f",
        "name": "ULTIMAS VOLUNTADES    Topic: IIX/ESPX/conexion",
        "info": "",
        "x": 310,
        "y": 80,
        "wires": []
    },
    {
        "id": "60d8ebbe4f8fd4f1",
        "type": "mqtt in",
        "z": "d43d9cbcc461780f",
        "name": "",
        "topic": "II1/ESP3098241/conexion",
        "qos": "2",
        "datatype": "auto",
        "broker": "819581010d48bfd0",
        "nl": false,
        "rap": true,
        "rh": 0,
        "x": 290,
        "y": 160,
        "wires": [
            [
                "2f31998b596e1427"
            ]
        ]
    },
    {
        "id": "7cb7a5d693c92927",
        "type": "mqtt in",
        "z": "d43d9cbcc461780f",
        "name": "",
        "topic": "II1/ESP9745759/conexion",
        "qos": "2",
        "datatype": "auto",
        "broker": "819581010d48bfd0",
        "nl": false,
        "rap": true,
        "rh": 0,
        "x": 290,
        "y": 220,
        "wires": [
            [
                "12a3a5600e761ab0"
            ]
        ]
    },
    {
        "id": "51d3aaa33b094031",
        "type": "mqtt in",
        "z": "d43d9cbcc461780f",
        "name": "",
        "topic": "II1/ESP10796726/conexion",
        "qos": "2",
        "datatype": "auto",
        "broker": "819581010d48bfd0",
        "nl": false,
        "rap": true,
        "rh": 0,
        "x": 290,
        "y": 280,
        "wires": [
            [
                "f8a77224eab13bf1"
            ]
        ]
    },
    {
        "id": "e5aeec9c34eeb7ba",
        "type": "mqtt in",
        "z": "d43d9cbcc461780f",
        "name": "",
        "topic": "II1/ESP1128666/conexion",
        "qos": "2",
        "datatype": "auto",
        "broker": "819581010d48bfd0",
        "nl": false,
        "rap": true,
        "rh": 0,
        "x": 290,
        "y": 340,
        "wires": [
            [
                "9a15ceebaacbb1c7"
            ]
        ]
    },
    {
        "id": "b5619481765b167c",
        "type": "function",
        "z": "d43d9cbcc461780f",
        "name": "",
        "func": "var online=msg.payload.online;\n\nif (!online)\n{\n    msg.payload=\"La placa: ESP_3098241 se ha desconectado.\";\n    msg.topic=\"ALERTA\";\n    \n    return msg;\n    \n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 680,
        "y": 160,
        "wires": [
            [
                "cd864960b798a258"
            ]
        ]
    },
    {
        "id": "cd864960b798a258",
        "type": "ui_toast",
        "z": "d43d9cbcc461780f",
        "position": "bottom right",
        "displayTime": "3",
        "highlight": "",
        "sendall": true,
        "outputs": 0,
        "ok": "OK",
        "cancel": "",
        "raw": false,
        "className": "",
        "topic": "",
        "name": "",
        "x": 930,
        "y": 240,
        "wires": []
    },
    {
        "id": "8afc31559b68e2e4",
        "type": "ui_gauge",
        "z": "d43d9cbcc461780f",
        "name": "",
        "group": "8bc36ba409dbee33",
        "order": 5,
        "width": 0,
        "height": 0,
        "gtype": "gage",
        "title": "Temperatura",
        "label": "ºC",
        "format": "{{value}}",
        "min": "10",
        "max": "45",
        "colors": [
            "#ff0000",
            "#00ff00",
            "#ff0000"
        ],
        "seg1": "15",
        "seg2": "40",
        "className": "",
        "x": 910,
        "y": 1700,
        "wires": []
    },
    {
        "id": "c428c4cee4e55f30",
        "type": "ui_gauge",
        "z": "d43d9cbcc461780f",
        "name": "",
        "group": "8bc36ba409dbee33",
        "order": 6,
        "width": 0,
        "height": 0,
        "gtype": "gage",
        "title": "Humedad",
        "label": "%",
        "format": "{{value}}",
        "min": "0",
        "max": "100",
        "colors": [
            "#ff0000",
            "#00ff00",
            "#ff0000"
        ],
        "seg1": "20",
        "seg2": "80",
        "className": "",
        "x": 900,
        "y": 1800,
        "wires": []
    },
    {
        "id": "bcd9d72ce6ec8138",
        "type": "ui_gauge",
        "z": "d43d9cbcc461780f",
        "name": "",
        "group": "5709fd4619421f28",
        "order": 5,
        "width": 0,
        "height": 0,
        "gtype": "gage",
        "title": "Temperatura",
        "label": "ºC",
        "format": "{{value}}",
        "min": "10",
        "max": "45",
        "colors": [
            "#ff0000",
            "#00ff00",
            "#ff0000"
        ],
        "seg1": "15",
        "seg2": "40",
        "className": "",
        "x": 2270,
        "y": 1700,
        "wires": []
    },
    {
        "id": "b3c2dd4cb984f4f7",
        "type": "ui_gauge",
        "z": "d43d9cbcc461780f",
        "name": "",
        "group": "5709fd4619421f28",
        "order": 6,
        "width": 0,
        "height": 0,
        "gtype": "gage",
        "title": "Humedad",
        "label": "%",
        "format": "{{value}}",
        "min": "0",
        "max": "100",
        "colors": [
            "#ff0000",
            "#00ff00",
            "#ff0000"
        ],
        "seg1": "20",
        "seg2": "80",
        "className": "",
        "x": 2260,
        "y": 1820,
        "wires": []
    },
    {
        "id": "87a98efc327b0ebc",
        "type": "ui_gauge",
        "z": "d43d9cbcc461780f",
        "name": "",
        "group": "a65ec6fec0e4c4fc",
        "order": 5,
        "width": 0,
        "height": 0,
        "gtype": "gage",
        "title": "Temperatura",
        "label": "ºC",
        "format": "{{value}}",
        "min": "10",
        "max": "45",
        "colors": [
            "#ff0000",
            "#00ff00",
            "#ff0000"
        ],
        "seg1": "15",
        "seg2": "40",
        "className": "",
        "x": 2250,
        "y": 840,
        "wires": []
    },
    {
        "id": "19a72187fe12fa9e",
        "type": "ui_gauge",
        "z": "d43d9cbcc461780f",
        "name": "",
        "group": "a65ec6fec0e4c4fc",
        "order": 6,
        "width": 0,
        "height": 0,
        "gtype": "gage",
        "title": "Humedad",
        "label": "%",
        "format": "{{value}}",
        "min": "0",
        "max": "100",
        "colors": [
            "#ff0000",
            "#00ff00",
            "#ff0000"
        ],
        "seg1": "20",
        "seg2": "80",
        "className": "",
        "x": 2240,
        "y": 940,
        "wires": []
    },
    {
        "id": "2f31998b596e1427",
        "type": "json",
        "z": "d43d9cbcc461780f",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 530,
        "y": 160,
        "wires": [
            [
                "b5619481765b167c",
                "79a72cbbf77bb2d8"
            ]
        ]
    },
    {
        "id": "6dd776bb02b86996",
        "type": "function",
        "z": "d43d9cbcc461780f",
        "name": "",
        "func": "var online=msg.payload.online;\n\nif (!online)\n{\n    msg.payload=\"La placa: ESP_9745759 se ha desconectado.\";\n    msg.topic=\"ALERTA\";\n    \n    return msg;\n    \n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 680,
        "y": 220,
        "wires": [
            [
                "cd864960b798a258"
            ]
        ]
    },
    {
        "id": "12a3a5600e761ab0",
        "type": "json",
        "z": "d43d9cbcc461780f",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 530,
        "y": 220,
        "wires": [
            [
                "6dd776bb02b86996",
                "79a72cbbf77bb2d8"
            ]
        ]
    },
    {
        "id": "c72f5571c3237f23",
        "type": "function",
        "z": "d43d9cbcc461780f",
        "name": "",
        "func": "var online=msg.payload.online;\n\nif (!online)\n{\n    msg.payload=\"La placa: ESP_10796726 se ha desconectado.\";\n    msg.topic=\"ALERTA\";\n    \n    return msg;\n    \n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 680,
        "y": 280,
        "wires": [
            [
                "cd864960b798a258"
            ]
        ]
    },
    {
        "id": "f8a77224eab13bf1",
        "type": "json",
        "z": "d43d9cbcc461780f",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 530,
        "y": 280,
        "wires": [
            [
                "c72f5571c3237f23",
                "79a72cbbf77bb2d8"
            ]
        ]
    },
    {
        "id": "a009e067c1094ea2",
        "type": "function",
        "z": "d43d9cbcc461780f",
        "name": "",
        "func": "var online=msg.payload.online;\n\nif (!online)\n{\n    msg.payload=\"La placa: ESP_1128666 se ha desconectado.\";\n    msg.topic=\"ALERTA\";\n    \n    return msg;\n    \n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 680,
        "y": 340,
        "wires": [
            [
                "cd864960b798a258"
            ]
        ]
    },
    {
        "id": "9a15ceebaacbb1c7",
        "type": "json",
        "z": "d43d9cbcc461780f",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 530,
        "y": 340,
        "wires": [
            [
                "a009e067c1094ea2",
                "79a72cbbf77bb2d8"
            ]
        ]
    },
    {
        "id": "e33319129b0f4e5f",
        "type": "debug",
        "z": "d43d9cbcc461780f",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 690,
        "y": 520,
        "wires": []
    },
    {
        "id": "79a72cbbf77bb2d8",
        "type": "debug",
        "z": "d43d9cbcc461780f",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 690,
        "y": 420,
        "wires": []
    },
    {
        "id": "8ad3bbdc0a269f93",
        "type": "debug",
        "z": "d43d9cbcc461780f",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 1110,
        "y": 3240,
        "wires": []
    },
    {
        "id": "3ec0cdf5f442a5bd",
        "type": "change",
        "z": "d43d9cbcc461780f",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "id_ESP_config",
                "pt": "flow",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 450,
        "y": 2800,
        "wires": [
            []
        ]
    },
    {
        "id": "166ed5e9248335ee",
        "type": "change",
        "z": "d43d9cbcc461780f",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "NivelLED",
                "pt": "flow",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 470,
        "y": 3120,
        "wires": [
            []
        ]
    },
    {
        "id": "d1b8562dbe6ff2f9",
        "type": "change",
        "z": "d43d9cbcc461780f",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "id_ESP_led",
                "pt": "flow",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 480,
        "y": 3240,
        "wires": [
            []
        ]
    },
    {
        "id": "eb95f464705b6232",
        "type": "change",
        "z": "d43d9cbcc461780f",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "max_temp",
                "pt": "flow",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 550,
        "y": 2860,
        "wires": [
            []
        ]
    },
    {
        "id": "ad8cd17a6ed45596",
        "type": "change",
        "z": "d43d9cbcc461780f",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "min_temp",
                "pt": "flow",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 550,
        "y": 2900,
        "wires": [
            []
        ]
    },
    {
        "id": "8a3b27ae2727f083",
        "type": "change",
        "z": "d43d9cbcc461780f",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "max_hum",
                "pt": "flow",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 550,
        "y": 2940,
        "wires": [
            []
        ]
    },
    {
        "id": "2828346050d1cf6d",
        "type": "change",
        "z": "d43d9cbcc461780f",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "min_hum",
                "pt": "flow",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 550,
        "y": 2980,
        "wires": [
            []
        ]
    },
    {
        "id": "59f5030f72c4fcd4",
        "type": "mqtt out",
        "z": "d43d9cbcc461780f",
        "name": "",
        "topic": "",
        "qos": "",
        "retain": "",
        "respTopic": "",
        "contentType": "",
        "userProps": "",
        "correl": "",
        "expiry": "",
        "broker": "819581010d48bfd0",
        "x": 1150,
        "y": 3180,
        "wires": []
    },
    {
        "id": "4a9a19f94a64d522",
        "type": "ui_toast",
        "z": "d43d9cbcc461780f",
        "position": "top right",
        "displayTime": "5",
        "highlight": "",
        "sendall": true,
        "outputs": 0,
        "ok": "OK",
        "cancel": "",
        "raw": false,
        "className": "",
        "topic": "",
        "name": "",
        "x": 1110,
        "y": 820,
        "wires": []
    },
    {
        "id": "8459c8e2f8c9faab",
        "type": "function",
        "z": "d43d9cbcc461780f",
        "name": "",
        "func": "const id_ESP=3098241;\n\nvar temp=msg.payload;\n\n//notificaciones:\nvar max_temp=flow.get(\"max_temp\");\nvar min_temp=flow.get(\"min_temp\");\n\n\nif (temp>=max_temp)\n{\n    msg.payload=\"TEMPERATURA MÁXIMA ALCANZADA\";\n    msg.topic=\"ALERTA EN: ESP-\"+id_ESP;\n    return msg;\n}\nelse if (temp<=min_temp)\n{\n    msg.payload=\"TEMPERATURA MÍNIMA ALCANZADA\";\n    msg.topic=\"ALERTA EN: ESP-\"+id_ESP;\n    return msg;\n}\n\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 920,
        "y": 820,
        "wires": [
            [
                "4a9a19f94a64d522"
            ]
        ]
    },
    {
        "id": "589d2bf4b18516f6",
        "type": "function",
        "z": "d43d9cbcc461780f",
        "name": "",
        "func": "const id_ESP=3098241;\n\nvar hum=msg.payload;\n\n//notificaciones\nvar max_hum=flow.get(\"max_hum\");\nvar min_hum=flow.get(\"min_hum\");\n\nif (hum>=max_hum)\n{\n    msg.payload=\"HUMEDAD MÁXIMA ALCANZADA\";\n    msg.topic=\"ALERTA EN: ESP-\"+id_ESP;\n    return msg;\n}\nelse if (hum<=min_hum)\n{\n    msg.payload=\"HUMEDAD MÍNIMA ALCANZADA\";\n    msg.topic=\"ALERTA EN: ESP-\"+id_ESP;\n    return msg;\n}\n\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 920,
        "y": 920,
        "wires": [
            [
                "35d315ac6b5a12ff"
            ]
        ]
    },
    {
        "id": "35d315ac6b5a12ff",
        "type": "ui_toast",
        "z": "d43d9cbcc461780f",
        "position": "top left",
        "displayTime": "5",
        "highlight": "",
        "sendall": true,
        "outputs": 0,
        "ok": "OK",
        "cancel": "",
        "raw": false,
        "className": "",
        "topic": "",
        "name": "",
        "x": 1110,
        "y": 920,
        "wires": []
    },
    {
        "id": "573a7cd38cd79eef",
        "type": "function",
        "z": "d43d9cbcc461780f",
        "name": "",
        "func": "const id_ESP=9745759;\n\nvar temp=msg.payload;\n\n//notificaciones:\nvar max_temp=flow.get(\"max_temp\");\nvar min_temp=flow.get(\"min_temp\");\n\n\nif (temp>=max_temp)\n{\n    msg.payload=\"TEMPERATURA MÁXIMA ALCANZADA\";\n    msg.topic=\"ALERTA EN: ESP-\"+id_ESP;\n    return msg;\n}\nelse if (temp<=min_temp)\n{\n    msg.payload=\"TEMPERATURA MÍNIMA ALCANZADA\";\n    msg.topic=\"ALERTA EN: ESP-\"+id_ESP;\n    return msg;\n}\n\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 920,
        "y": 1660,
        "wires": [
            [
                "ef26cb189573a072"
            ]
        ]
    },
    {
        "id": "80fd7cefce34f8cc",
        "type": "function",
        "z": "d43d9cbcc461780f",
        "name": "",
        "func": "const id_ESP=1128666;\n\nvar temp=msg.payload;\n\n//notificaciones:\nvar max_temp=flow.get(\"max_temp\");\nvar min_temp=flow.get(\"min_temp\");\n\n\nif (temp>=max_temp)\n{\n    msg.payload=\"TEMPERATURA MÁXIMA ALCANZADA\";\n    msg.topic=\"ALERTA EN: ESP-\"+id_ESP;\n    return msg;\n}\nelse if (temp<=min_temp)\n{\n    msg.payload=\"TEMPERATURA MÍNIMA ALCANZADA\";\n    msg.topic=\"ALERTA EN: ESP-\"+id_ESP;\n    return msg;\n}\n\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 2260,
        "y": 1660,
        "wires": [
            [
                "013799e6855e9843"
            ]
        ]
    },
    {
        "id": "30e113a0603d93db",
        "type": "function",
        "z": "d43d9cbcc461780f",
        "name": "",
        "func": "const id_ESP=10796726;\n\nvar temp=msg.payload;\n\n//notificaciones:\nvar max_temp=flow.get(\"max_temp\");\nvar min_temp=flow.get(\"min_temp\");\n\n\nif (temp>=max_temp)\n{\n    msg.payload=\"TEMPERATURA MÁXIMA ALCANZADA\";\n    msg.topic=\"ALERTA EN: ESP-\"+id_ESP;\n    return msg;\n}\nelse if (temp<=min_temp)\n{\n    msg.payload=\"TEMPERATURA MÍNIMA ALCANZADA\";\n    msg.topic=\"ALERTA EN: ESP-\"+id_ESP;\n    return msg;\n}\n\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 2240,
        "y": 800,
        "wires": [
            [
                "8945252ee2047361"
            ]
        ]
    },
    {
        "id": "ef26cb189573a072",
        "type": "ui_toast",
        "z": "d43d9cbcc461780f",
        "position": "top right",
        "displayTime": "5",
        "highlight": "",
        "sendall": true,
        "outputs": 0,
        "ok": "OK",
        "cancel": "",
        "raw": false,
        "className": "",
        "topic": "",
        "name": "",
        "x": 1110,
        "y": 1660,
        "wires": []
    },
    {
        "id": "013799e6855e9843",
        "type": "ui_toast",
        "z": "d43d9cbcc461780f",
        "position": "top right",
        "displayTime": "5",
        "highlight": "",
        "sendall": true,
        "outputs": 0,
        "ok": "OK",
        "cancel": "",
        "raw": false,
        "className": "",
        "topic": "",
        "name": "",
        "x": 2490,
        "y": 1660,
        "wires": []
    },
    {
        "id": "8945252ee2047361",
        "type": "ui_toast",
        "z": "d43d9cbcc461780f",
        "position": "top right",
        "displayTime": "5",
        "highlight": "",
        "sendall": true,
        "outputs": 0,
        "ok": "OK",
        "cancel": "",
        "raw": false,
        "className": "",
        "topic": "",
        "name": "",
        "x": 2450,
        "y": 800,
        "wires": []
    },
    {
        "id": "14557f2b51804d43",
        "type": "function",
        "z": "d43d9cbcc461780f",
        "name": "",
        "func": "const id_ESP=9745759;\n\nvar hum=msg.payload;\n\n\n//notificaciones\nvar max_hum=flow.get(\"max_hum\");\nvar min_hum=flow.get(\"min_hum\");\n\nif (hum>=max_hum)\n{\n    msg.payload=\"HUMEDAD MÁXIMA ALCANZADA\";\n    msg.topic=\"ALERTA EN: ESP-\"+id_ESP;\n    return msg;\n}\nelse if (hum<=min_hum)\n{\n    msg.payload=\"HUMEDAD MÍNIMA ALCANZADA\";\n    msg.topic=\"ALERTA EN: ESP-\"+id_ESP;\n    return msg;\n}\n\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 900,
        "y": 1760,
        "wires": [
            [
                "892e79ef20751bba"
            ]
        ]
    },
    {
        "id": "892e79ef20751bba",
        "type": "ui_toast",
        "z": "d43d9cbcc461780f",
        "position": "top left",
        "displayTime": "5",
        "highlight": "",
        "sendall": true,
        "outputs": 0,
        "ok": "OK",
        "cancel": "",
        "raw": false,
        "className": "",
        "topic": "",
        "name": "",
        "x": 1090,
        "y": 1760,
        "wires": []
    },
    {
        "id": "a2d3b489f945157a",
        "type": "function",
        "z": "d43d9cbcc461780f",
        "name": "",
        "func": "const id_ESP=1128666;\n\nvar hum=msg.payload;\n\n\n//notificaciones\nvar max_hum=flow.get(\"max_hum\");\nvar min_hum=flow.get(\"min_hum\");\n\nif (hum>=max_hum)\n{\n    msg.payload=\"HUMEDAD MÁXIMA ALCANZADA\";\n    msg.topic=\"ALERTA EN: ESP-\"+id_ESP;\n    return msg;\n}\nelse if (hum<=min_hum)\n{\n    msg.payload=\"HUMEDAD MÍNIMA ALCANZADA\";\n    msg.topic=\"ALERTA EN: ESP-\"+id_ESP;\n    return msg;\n}\n\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 2260,
        "y": 1780,
        "wires": [
            [
                "1f511ccd9565595a"
            ]
        ]
    },
    {
        "id": "1f35ba7f818e9e45",
        "type": "function",
        "z": "d43d9cbcc461780f",
        "name": "",
        "func": "const id_ESP=10796726;\n\nvar hum=msg.payload;\n\n//notificaciones\nvar max_hum=flow.get(\"max_hum\");\nvar min_hum=flow.get(\"min_hum\");\n\nif (hum>=max_hum)\n{\n    msg.payload=\"HUMEDAD MÁXIMA ALCANZADA\";\n    msg.topic=\"ALERTA EN: ESP-\"+id_ESP;\n    return msg;\n}\nelse if (hum<=min_hum)\n{\n    msg.payload=\"HUMEDAD MÍNIMA ALCANZADA\";\n    msg.topic=\"ALERTA EN: ESP-\"+id_ESP;\n    return msg;\n}\n\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 2240,
        "y": 900,
        "wires": [
            [
                "e7def827317329ec"
            ]
        ]
    },
    {
        "id": "e7def827317329ec",
        "type": "ui_toast",
        "z": "d43d9cbcc461780f",
        "position": "top left",
        "displayTime": "5",
        "highlight": "",
        "sendall": true,
        "outputs": 0,
        "ok": "OK",
        "cancel": "",
        "raw": false,
        "className": "",
        "topic": "",
        "name": "",
        "x": 2470,
        "y": 900,
        "wires": []
    },
    {
        "id": "1f511ccd9565595a",
        "type": "ui_toast",
        "z": "d43d9cbcc461780f",
        "position": "top left",
        "displayTime": "5",
        "highlight": "",
        "sendall": true,
        "outputs": 0,
        "ok": "OK",
        "cancel": "",
        "raw": false,
        "className": "",
        "topic": "",
        "name": "",
        "x": 2470,
        "y": 1780,
        "wires": []
    },
    {
        "id": "9ac5a808241ee102",
        "type": "comment",
        "z": "d43d9cbcc461780f",
        "name": "Topic: IIX/ESPX/led/status",
        "info": "",
        "x": 230,
        "y": 2220,
        "wires": []
    },
    {
        "id": "f40449fa971eed9a",
        "type": "mqtt in",
        "z": "d43d9cbcc461780f",
        "name": "",
        "topic": "II1/ESP3098241/led/status",
        "qos": "2",
        "datatype": "auto",
        "broker": "819581010d48bfd0",
        "nl": false,
        "rap": true,
        "rh": 0,
        "x": 300,
        "y": 2280,
        "wires": [
            [
                "1448826b6ba58400"
            ]
        ]
    },
    {
        "id": "86dfa9b9a1d7f31f",
        "type": "mqtt in",
        "z": "d43d9cbcc461780f",
        "name": "",
        "topic": "II1/ESP9745759/led/status",
        "qos": "2",
        "datatype": "auto",
        "broker": "819581010d48bfd0",
        "nl": false,
        "rap": true,
        "rh": 0,
        "x": 300,
        "y": 2340,
        "wires": [
            [
                "02f3907e3b3ccad5"
            ]
        ]
    },
    {
        "id": "8f50edad54170679",
        "type": "mqtt in",
        "z": "d43d9cbcc461780f",
        "name": "",
        "topic": "II1/ESP10796726/led/status",
        "qos": "2",
        "datatype": "auto",
        "broker": "819581010d48bfd0",
        "nl": false,
        "rap": true,
        "rh": 0,
        "x": 300,
        "y": 2400,
        "wires": [
            [
                "19abf64239654ca0"
            ]
        ]
    },
    {
        "id": "c2c213b6f327ec14",
        "type": "mqtt in",
        "z": "d43d9cbcc461780f",
        "name": "",
        "topic": "II1/ESP1128666/led/status",
        "qos": "2",
        "datatype": "auto",
        "broker": "819581010d48bfd0",
        "nl": false,
        "rap": true,
        "rh": 0,
        "x": 300,
        "y": 2460,
        "wires": [
            [
                "242195ff6910cfbe"
            ]
        ]
    },
    {
        "id": "08f4d67c394bd21a",
        "type": "debug",
        "z": "d43d9cbcc461780f",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 730,
        "y": 2200,
        "wires": []
    },
    {
        "id": "1448826b6ba58400",
        "type": "json",
        "z": "d43d9cbcc461780f",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 530,
        "y": 2280,
        "wires": [
            [
                "08f4d67c394bd21a",
                "1d1767caf8a29008"
            ]
        ]
    },
    {
        "id": "1d1767caf8a29008",
        "type": "change",
        "z": "d43d9cbcc461780f",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.origen",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 730,
        "y": 2280,
        "wires": [
            [
                "b6440f9e8f170b6b"
            ]
        ]
    },
    {
        "id": "b6440f9e8f170b6b",
        "type": "ui_text",
        "z": "d43d9cbcc461780f",
        "group": "cc1d7259111dc549",
        "order": 8,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "ORIGEN NivelLED: ",
        "format": "{{msg.payload}}",
        "layout": "row-left",
        "className": "",
        "x": 950,
        "y": 2280,
        "wires": []
    },
    {
        "id": "02f3907e3b3ccad5",
        "type": "json",
        "z": "d43d9cbcc461780f",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 530,
        "y": 2340,
        "wires": [
            [
                "70a93edcb5e917ca"
            ]
        ]
    },
    {
        "id": "70a93edcb5e917ca",
        "type": "change",
        "z": "d43d9cbcc461780f",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.origen",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 730,
        "y": 2340,
        "wires": [
            [
                "cdfd2bed16d5f7d2"
            ]
        ]
    },
    {
        "id": "cdfd2bed16d5f7d2",
        "type": "ui_text",
        "z": "d43d9cbcc461780f",
        "group": "8bc36ba409dbee33",
        "order": 8,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "ORIGEN NivelLED: ",
        "format": "{{msg.payload}}",
        "layout": "row-left",
        "className": "",
        "x": 950,
        "y": 2340,
        "wires": []
    },
    {
        "id": "19abf64239654ca0",
        "type": "json",
        "z": "d43d9cbcc461780f",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 530,
        "y": 2400,
        "wires": [
            [
                "cd23592b29c62f99"
            ]
        ]
    },
    {
        "id": "cd23592b29c62f99",
        "type": "change",
        "z": "d43d9cbcc461780f",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.origen",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 730,
        "y": 2400,
        "wires": [
            [
                "a8dd09b9ba6ae18a"
            ]
        ]
    },
    {
        "id": "a8dd09b9ba6ae18a",
        "type": "ui_text",
        "z": "d43d9cbcc461780f",
        "group": "a65ec6fec0e4c4fc",
        "order": 8,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "ORIGEN NivelLED: ",
        "format": "{{msg.payload}}",
        "layout": "row-left",
        "className": "",
        "x": 950,
        "y": 2400,
        "wires": []
    },
    {
        "id": "242195ff6910cfbe",
        "type": "json",
        "z": "d43d9cbcc461780f",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 530,
        "y": 2460,
        "wires": [
            [
                "f1de6c9d6b44aa46"
            ]
        ]
    },
    {
        "id": "f1de6c9d6b44aa46",
        "type": "change",
        "z": "d43d9cbcc461780f",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.origen",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 730,
        "y": 2460,
        "wires": [
            [
                "4e0f3348f18382f8"
            ]
        ]
    },
    {
        "id": "4e0f3348f18382f8",
        "type": "ui_text",
        "z": "d43d9cbcc461780f",
        "group": "5709fd4619421f28",
        "order": 8,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "ORIGEN NivelLED: ",
        "format": "{{msg.payload}}",
        "layout": "row-left",
        "className": "",
        "x": 950,
        "y": 2460,
        "wires": []
    },
    {
        "id": "c8bea932d84f3fbc",
        "type": "comment",
        "z": "d43d9cbcc461780f",
        "name": "ACTUADORES    Topic: IIX/ESPX/switch/cmd",
        "info": "",
        "x": 290,
        "y": 3320,
        "wires": []
    },
    {
        "id": "b3399d8289793089",
        "type": "ui_switch",
        "z": "d43d9cbcc461780f",
        "name": "",
        "label": "switch",
        "tooltip": "",
        "group": "1188649fe7bc9814",
        "order": 1,
        "width": 0,
        "height": 0,
        "passthru": true,
        "decouple": "false",
        "topic": "",
        "topicType": "str",
        "style": "",
        "onvalue": "1",
        "onvalueType": "num",
        "onicon": "",
        "oncolor": "",
        "offvalue": "0",
        "offvalueType": "num",
        "officon": "",
        "offcolor": "",
        "animate": false,
        "className": "",
        "x": 230,
        "y": 3380,
        "wires": [
            [
                "c709e73e19289721",
                "fe877e78f9cca791"
            ]
        ]
    },
    {
        "id": "c709e73e19289721",
        "type": "ui_text",
        "z": "d43d9cbcc461780f",
        "group": "1188649fe7bc9814",
        "order": 2,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Switch en modo seleccionado:",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 450,
        "y": 3420,
        "wires": []
    },
    {
        "id": "b317d02f6cc1ac1f",
        "type": "function",
        "z": "d43d9cbcc461780f",
        "name": "Payload JSON y TOPIC enviar",
        "func": "var switch_=flow.get(\"switch_\");\nvar idESP=flow.get(\"id_ESP_switch\");\n\nmsg.payload={\"level\":switch_};\n\nmsg.topic=\"II1/ESP\"+idESP+\"/switch/cmd\";\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 870,
        "y": 3440,
        "wires": [
            [
                "e40fa4d65aec2c3b",
                "33f19299884a088b"
            ]
        ]
    },
    {
        "id": "1da2bda53f0ba8c7",
        "type": "ui_dropdown",
        "z": "d43d9cbcc461780f",
        "name": "",
        "label": "SELECT ESP",
        "tooltip": "",
        "place": "seleccione un ESP",
        "group": "1188649fe7bc9814",
        "order": 3,
        "width": 0,
        "height": 0,
        "passthru": true,
        "multiple": false,
        "options": [
            {
                "label": "ESP1_cris",
                "value": "3098241",
                "type": "str"
            },
            {
                "label": "ESP2_hugo",
                "value": "9745759",
                "type": "str"
            },
            {
                "label": "ESP3_javi",
                "value": "10796726",
                "type": "str"
            },
            {
                "label": "ESP4_julian",
                "value": "1128666",
                "type": "str"
            }
        ],
        "payload": "",
        "topic": "id_ESP_switch",
        "topicType": "flow",
        "className": "",
        "x": 260,
        "y": 3500,
        "wires": [
            [
                "bb4b60c0b44efbe0"
            ]
        ]
    },
    {
        "id": "e5992dffec3f8ce0",
        "type": "ui_button",
        "z": "d43d9cbcc461780f",
        "name": "",
        "group": "1188649fe7bc9814",
        "order": 3,
        "width": 0,
        "height": 0,
        "passthru": false,
        "label": "Botón",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "",
        "payload": "",
        "payloadType": "str",
        "topic": "topic",
        "topicType": "msg",
        "x": 660,
        "y": 3440,
        "wires": [
            [
                "b317d02f6cc1ac1f"
            ]
        ]
    },
    {
        "id": "bb4b60c0b44efbe0",
        "type": "change",
        "z": "d43d9cbcc461780f",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "id_ESP_switch",
                "pt": "flow",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 470,
        "y": 3500,
        "wires": [
            []
        ]
    },
    {
        "id": "fe877e78f9cca791",
        "type": "change",
        "z": "d43d9cbcc461780f",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "switch_",
                "pt": "flow",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 420,
        "y": 3380,
        "wires": [
            []
        ]
    },
    {
        "id": "e40fa4d65aec2c3b",
        "type": "mqtt out",
        "z": "d43d9cbcc461780f",
        "name": "",
        "topic": "",
        "qos": "",
        "retain": "",
        "respTopic": "",
        "contentType": "",
        "userProps": "",
        "correl": "",
        "expiry": "",
        "broker": "819581010d48bfd0",
        "x": 1150,
        "y": 3440,
        "wires": []
    },
    {
        "id": "86adeb5e6c2b0852",
        "type": "comment",
        "z": "d43d9cbcc461780f",
        "name": "Topic: IIX/ESPX/led/status",
        "info": "",
        "x": 1570,
        "y": 2220,
        "wires": []
    },
    {
        "id": "70195997bbdbd410",
        "type": "mqtt in",
        "z": "d43d9cbcc461780f",
        "name": "",
        "topic": "II1/ESP3098241/switch/status",
        "qos": "2",
        "datatype": "auto",
        "broker": "819581010d48bfd0",
        "nl": false,
        "rap": true,
        "rh": 0,
        "x": 1650,
        "y": 2280,
        "wires": [
            [
                "4bdc626398070df2"
            ]
        ]
    },
    {
        "id": "ef3fd1f4a1af902b",
        "type": "mqtt in",
        "z": "d43d9cbcc461780f",
        "name": "",
        "topic": "II1/ESP9745759/switch/status",
        "qos": "2",
        "datatype": "auto",
        "broker": "819581010d48bfd0",
        "nl": false,
        "rap": true,
        "rh": 0,
        "x": 1650,
        "y": 2340,
        "wires": [
            [
                "e621aae777f5bf52"
            ]
        ]
    },
    {
        "id": "e534379a16a1826a",
        "type": "mqtt in",
        "z": "d43d9cbcc461780f",
        "name": "",
        "topic": "II1/ESP10796726/switch/status",
        "qos": "2",
        "datatype": "auto",
        "broker": "819581010d48bfd0",
        "nl": false,
        "rap": true,
        "rh": 0,
        "x": 1650,
        "y": 2400,
        "wires": [
            [
                "cbf23d221e3a94c5"
            ]
        ]
    },
    {
        "id": "a9827b2b50f9876a",
        "type": "mqtt in",
        "z": "d43d9cbcc461780f",
        "name": "",
        "topic": "II1/ESP1128666/switch/status",
        "qos": "2",
        "datatype": "auto",
        "broker": "819581010d48bfd0",
        "nl": false,
        "rap": true,
        "rh": 0,
        "x": 1650,
        "y": 2460,
        "wires": [
            [
                "5cf6c7efa20dc326"
            ]
        ]
    },
    {
        "id": "ada3cde9f301a0a8",
        "type": "debug",
        "z": "d43d9cbcc461780f",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 2090,
        "y": 2200,
        "wires": []
    },
    {
        "id": "4bdc626398070df2",
        "type": "json",
        "z": "d43d9cbcc461780f",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 1870,
        "y": 2280,
        "wires": [
            [
                "ada3cde9f301a0a8",
                "e63ef56eeeb88c97"
            ]
        ]
    },
    {
        "id": "e63ef56eeeb88c97",
        "type": "change",
        "z": "d43d9cbcc461780f",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.origen",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 2070,
        "y": 2280,
        "wires": [
            [
                "a4fa6ecfff38cd2c"
            ]
        ]
    },
    {
        "id": "a4fa6ecfff38cd2c",
        "type": "ui_text",
        "z": "d43d9cbcc461780f",
        "group": "cc1d7259111dc549",
        "order": 10,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "ORIGEN SWITCH: ",
        "format": "{{msg.payload}}",
        "layout": "row-left",
        "className": "",
        "x": 2290,
        "y": 2280,
        "wires": []
    },
    {
        "id": "e621aae777f5bf52",
        "type": "json",
        "z": "d43d9cbcc461780f",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 1870,
        "y": 2340,
        "wires": [
            [
                "49a20e852c362a3f"
            ]
        ]
    },
    {
        "id": "49a20e852c362a3f",
        "type": "change",
        "z": "d43d9cbcc461780f",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.origen",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 2070,
        "y": 2340,
        "wires": [
            [
                "a720bd19d31b6579"
            ]
        ]
    },
    {
        "id": "a720bd19d31b6579",
        "type": "ui_text",
        "z": "d43d9cbcc461780f",
        "group": "8bc36ba409dbee33",
        "order": 10,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "ORIGEN SWITCH: ",
        "format": "{{msg.payload}}",
        "layout": "row-left",
        "className": "",
        "x": 2290,
        "y": 2340,
        "wires": []
    },
    {
        "id": "cbf23d221e3a94c5",
        "type": "json",
        "z": "d43d9cbcc461780f",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 1870,
        "y": 2400,
        "wires": [
            [
                "0da3e24d90382056"
            ]
        ]
    },
    {
        "id": "0da3e24d90382056",
        "type": "change",
        "z": "d43d9cbcc461780f",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.origen",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 2070,
        "y": 2400,
        "wires": [
            [
                "4a08ddcfb17c76ec"
            ]
        ]
    },
    {
        "id": "4a08ddcfb17c76ec",
        "type": "ui_text",
        "z": "d43d9cbcc461780f",
        "group": "a65ec6fec0e4c4fc",
        "order": 10,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "ORIGEN SWITCH: ",
        "format": "{{msg.payload}}",
        "layout": "row-left",
        "className": "",
        "x": 2290,
        "y": 2400,
        "wires": []
    },
    {
        "id": "5cf6c7efa20dc326",
        "type": "json",
        "z": "d43d9cbcc461780f",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 1870,
        "y": 2460,
        "wires": [
            [
                "2008bc41bab61bb9"
            ]
        ]
    },
    {
        "id": "2008bc41bab61bb9",
        "type": "change",
        "z": "d43d9cbcc461780f",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.origen",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 2070,
        "y": 2460,
        "wires": [
            [
                "1e50869302caf7fb"
            ]
        ]
    },
    {
        "id": "1e50869302caf7fb",
        "type": "ui_text",
        "z": "d43d9cbcc461780f",
        "group": "5709fd4619421f28",
        "order": 10,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "ORIGEN SWITCH: ",
        "format": "{{msg.payload}}",
        "layout": "row-left",
        "className": "",
        "x": 2290,
        "y": 2460,
        "wires": []
    },
    {
        "id": "33f19299884a088b",
        "type": "debug",
        "z": "d43d9cbcc461780f",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 1110,
        "y": 3520,
        "wires": []
    },
    {
        "id": "4ec0f4212f49b6a8",
        "type": "change",
        "z": "d43d9cbcc461780f",
        "name": "WIFI_SSId",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.Wifi.SSId",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 690,
        "y": 1120,
        "wires": [
            [
                "f7efd51cf0c7b2df"
            ]
        ]
    },
    {
        "id": "4a5e0924d22af9d8",
        "type": "change",
        "z": "d43d9cbcc461780f",
        "name": "WIFI_IP",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.Wifi.IP",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 680,
        "y": 1160,
        "wires": [
            [
                "a96ea52645d46de9"
            ]
        ]
    },
    {
        "id": "ec243fdc392be9b2",
        "type": "change",
        "z": "d43d9cbcc461780f",
        "name": "WIFI_RSSI",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.Wifi.RSSI",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 690,
        "y": 1200,
        "wires": [
            [
                "6168be4a4174ab52"
            ]
        ]
    },
    {
        "id": "f7efd51cf0c7b2df",
        "type": "ui_text",
        "z": "d43d9cbcc461780f",
        "group": "cc1d7259111dc549",
        "order": 11,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "WIFI SSId: ",
        "format": "{{msg.payload}}",
        "layout": "row-center",
        "className": "",
        "x": 930,
        "y": 1120,
        "wires": []
    },
    {
        "id": "a96ea52645d46de9",
        "type": "ui_text",
        "z": "d43d9cbcc461780f",
        "group": "cc1d7259111dc549",
        "order": 12,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "WIFI IP: ",
        "format": "{{msg.payload}}",
        "layout": "row-center",
        "className": "",
        "x": 920,
        "y": 1160,
        "wires": []
    },
    {
        "id": "6168be4a4174ab52",
        "type": "ui_text",
        "z": "d43d9cbcc461780f",
        "group": "cc1d7259111dc549",
        "order": 13,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "WIFI RSSI: ",
        "format": "{{msg.payload}}",
        "layout": "row-center",
        "className": "",
        "x": 930,
        "y": 1200,
        "wires": []
    },
    {
        "id": "d28a02528ea09b79",
        "type": "change",
        "z": "d43d9cbcc461780f",
        "name": "WIFI_SSId",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.Wifi.SSId",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 690,
        "y": 1960,
        "wires": [
            [
                "242971c1ce531e1b"
            ]
        ]
    },
    {
        "id": "3f6f035bcc51e361",
        "type": "change",
        "z": "d43d9cbcc461780f",
        "name": "WIFI_IP",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.Wifi.IP",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 680,
        "y": 2000,
        "wires": [
            [
                "94b9c36d0bb3daf1"
            ]
        ]
    },
    {
        "id": "6e1a7af203180627",
        "type": "change",
        "z": "d43d9cbcc461780f",
        "name": "WIFI_RSSI",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.Wifi.RSSI",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 690,
        "y": 2040,
        "wires": [
            [
                "8980c69ef839a6b8"
            ]
        ]
    },
    {
        "id": "242971c1ce531e1b",
        "type": "ui_text",
        "z": "d43d9cbcc461780f",
        "group": "8bc36ba409dbee33",
        "order": 11,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "WIFI SSId: ",
        "format": "{{msg.payload}}",
        "layout": "row-center",
        "className": "",
        "x": 930,
        "y": 1960,
        "wires": []
    },
    {
        "id": "94b9c36d0bb3daf1",
        "type": "ui_text",
        "z": "d43d9cbcc461780f",
        "group": "8bc36ba409dbee33",
        "order": 12,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "WIFI IP: ",
        "format": "{{msg.payload}}",
        "layout": "row-center",
        "className": "",
        "x": 920,
        "y": 2000,
        "wires": []
    },
    {
        "id": "8980c69ef839a6b8",
        "type": "ui_text",
        "z": "d43d9cbcc461780f",
        "group": "8bc36ba409dbee33",
        "order": 13,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "WIFI RSSI: ",
        "format": "{{msg.payload}}",
        "layout": "row-center",
        "className": "",
        "x": 930,
        "y": 2040,
        "wires": []
    },
    {
        "id": "3318f89c0ab9de94",
        "type": "change",
        "z": "d43d9cbcc461780f",
        "name": "WIFI_SSId",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.Wifi.SSId",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 2030,
        "y": 1120,
        "wires": [
            [
                "cb9451b1a11505e1"
            ]
        ]
    },
    {
        "id": "ab70f6a5aa9b82d8",
        "type": "change",
        "z": "d43d9cbcc461780f",
        "name": "WIFI_IP",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.Wifi.IP",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 2020,
        "y": 1160,
        "wires": [
            [
                "49b8f2081a2377cb"
            ]
        ]
    },
    {
        "id": "75bc7d9f2e69c361",
        "type": "change",
        "z": "d43d9cbcc461780f",
        "name": "WIFI_RSSI",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.Wifi.RSSI",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 2030,
        "y": 1200,
        "wires": [
            [
                "4c9b6754c4f79182"
            ]
        ]
    },
    {
        "id": "cb9451b1a11505e1",
        "type": "ui_text",
        "z": "d43d9cbcc461780f",
        "group": "a65ec6fec0e4c4fc",
        "order": 11,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "WIFI SSId: ",
        "format": "{{msg.payload}}",
        "layout": "row-center",
        "className": "",
        "x": 2270,
        "y": 1120,
        "wires": []
    },
    {
        "id": "49b8f2081a2377cb",
        "type": "ui_text",
        "z": "d43d9cbcc461780f",
        "group": "a65ec6fec0e4c4fc",
        "order": 12,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "WIFI IP: ",
        "format": "{{msg.payload}}",
        "layout": "row-center",
        "className": "",
        "x": 2260,
        "y": 1160,
        "wires": []
    },
    {
        "id": "4c9b6754c4f79182",
        "type": "ui_text",
        "z": "d43d9cbcc461780f",
        "group": "a65ec6fec0e4c4fc",
        "order": 13,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "WIFI RSSI: ",
        "format": "{{msg.payload}}",
        "layout": "row-center",
        "className": "",
        "x": 2270,
        "y": 1200,
        "wires": []
    },
    {
        "id": "8af42a7a91bd63bf",
        "type": "change",
        "z": "d43d9cbcc461780f",
        "name": "WIFI_SSId",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.Wifi.SSId",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 2030,
        "y": 2000,
        "wires": [
            [
                "35107a030c9cf292"
            ]
        ]
    },
    {
        "id": "70c13592025310c8",
        "type": "change",
        "z": "d43d9cbcc461780f",
        "name": "WIFI_IP",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.Wifi.IP",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 2020,
        "y": 2040,
        "wires": [
            [
                "02fc069ae1f1985c"
            ]
        ]
    },
    {
        "id": "3499c96f9d8adfc6",
        "type": "change",
        "z": "d43d9cbcc461780f",
        "name": "WIFI_RSSI",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.Wifi.RSSI",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 2030,
        "y": 2080,
        "wires": [
            [
                "68dd56050f95eef9"
            ]
        ]
    },
    {
        "id": "35107a030c9cf292",
        "type": "ui_text",
        "z": "d43d9cbcc461780f",
        "group": "5709fd4619421f28",
        "order": 11,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "WIFI SSId: ",
        "format": "{{msg.payload}}",
        "layout": "row-center",
        "className": "",
        "x": 2270,
        "y": 2000,
        "wires": []
    },
    {
        "id": "02fc069ae1f1985c",
        "type": "ui_text",
        "z": "d43d9cbcc461780f",
        "group": "5709fd4619421f28",
        "order": 12,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "WIFI IP: ",
        "format": "{{msg.payload}}",
        "layout": "row-center",
        "className": "",
        "x": 2260,
        "y": 2040,
        "wires": []
    },
    {
        "id": "68dd56050f95eef9",
        "type": "ui_text",
        "z": "d43d9cbcc461780f",
        "group": "5709fd4619421f28",
        "order": 13,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "WIFI RSSI: ",
        "format": "{{msg.payload}}",
        "layout": "row-center",
        "className": "",
        "x": 2270,
        "y": 2080,
        "wires": []
    },
    {
        "id": "03dbe818c7eddb9f",
        "type": "json",
        "z": "d43d9cbcc461780f",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 3190,
        "y": 220,
        "wires": [
            [
                "544fc0f05cb8d9cb",
                "554e4632b7e87545"
            ]
        ]
    },
    {
        "id": "544fc0f05cb8d9cb",
        "type": "function",
        "z": "d43d9cbcc461780f",
        "name": "añade fecha",
        "func": "msg.payload.date=new Date();\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 3390,
        "y": 220,
        "wires": [
            [
                "a49afec6c79868a7"
            ]
        ]
    },
    {
        "id": "a49afec6c79868a7",
        "type": "mongodb out",
        "z": "d43d9cbcc461780f",
        "mongodb": "3752afa1.deaf9",
        "name": "",
        "collection": "Proyecto1_Datos",
        "payonly": true,
        "upsert": false,
        "multi": false,
        "operation": "store",
        "x": 3660,
        "y": 220,
        "wires": []
    },
    {
        "id": "913c89484be673a9",
        "type": "mqtt in",
        "z": "d43d9cbcc461780f",
        "name": "",
        "topic": "II1/ESP3098241/datos",
        "qos": "2",
        "datatype": "auto",
        "broker": "0c8bf2f642261bd9",
        "nl": false,
        "rap": true,
        "rh": 0,
        "x": 2960,
        "y": 220,
        "wires": [
            [
                "03dbe818c7eddb9f"
            ]
        ]
    },
    {
        "id": "e2ac2f7b1eb2cadf",
        "type": "mongodb out",
        "z": "d43d9cbcc461780f",
        "mongodb": "3752afa1.deaf9",
        "name": "",
        "collection": "Proyecto1_Actuadores",
        "payonly": true,
        "upsert": false,
        "multi": false,
        "operation": "store",
        "x": 4820,
        "y": 200,
        "wires": []
    },
    {
        "id": "6e71d87911ea166f",
        "type": "mqtt in",
        "z": "d43d9cbcc461780f",
        "name": "",
        "topic": "II1/ESP9745759/led/status",
        "qos": "2",
        "datatype": "auto",
        "broker": "0c8bf2f642261bd9",
        "nl": false,
        "rap": true,
        "rh": 0,
        "x": 4170,
        "y": 200,
        "wires": [
            [
                "179dc3cfe357bbce"
            ]
        ]
    },
    {
        "id": "179dc3cfe357bbce",
        "type": "json",
        "z": "d43d9cbcc461780f",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 4410,
        "y": 200,
        "wires": [
            [
                "e25d0b5b51a1870e"
            ]
        ]
    },
    {
        "id": "e25d0b5b51a1870e",
        "type": "function",
        "z": "d43d9cbcc461780f",
        "name": "añade fecha",
        "func": "msg.payload.date=new Date();\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 4550,
        "y": 200,
        "wires": [
            [
                "e2ac2f7b1eb2cadf"
            ]
        ]
    },
    {
        "id": "b4802eaf2f41022b",
        "type": "mqtt in",
        "z": "d43d9cbcc461780f",
        "name": "",
        "topic": "II1/ESP9745759/switch/status",
        "qos": "2",
        "datatype": "auto",
        "broker": "0c8bf2f642261bd9",
        "nl": false,
        "rap": true,
        "rh": 0,
        "x": 4180,
        "y": 260,
        "wires": [
            [
                "179dc3cfe357bbce"
            ]
        ]
    },
    {
        "id": "554e4632b7e87545",
        "type": "debug",
        "z": "d43d9cbcc461780f",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 3350,
        "y": 320,
        "wires": []
    },
    {
        "id": "5b923b35a4a18fdc",
        "type": "mqtt in",
        "z": "d43d9cbcc461780f",
        "name": "",
        "topic": "II1/ESP9745759/datos",
        "qos": "2",
        "datatype": "auto",
        "broker": "0c8bf2f642261bd9",
        "nl": false,
        "rap": true,
        "rh": 0,
        "x": 2960,
        "y": 280,
        "wires": [
            [
                "03dbe818c7eddb9f"
            ]
        ]
    },
    {
        "id": "4953da036bb79959",
        "type": "mqtt in",
        "z": "d43d9cbcc461780f",
        "name": "",
        "topic": "II1/ESP1128666/datos",
        "qos": "2",
        "datatype": "auto",
        "broker": "0c8bf2f642261bd9",
        "nl": false,
        "rap": true,
        "rh": 0,
        "x": 2960,
        "y": 340,
        "wires": [
            [
                "03dbe818c7eddb9f"
            ]
        ]
    },
    {
        "id": "8e75fd5e2cb88bd7",
        "type": "mqtt in",
        "z": "d43d9cbcc461780f",
        "name": "",
        "topic": "II1/ESP10796726/datos",
        "qos": "2",
        "datatype": "auto",
        "broker": "0c8bf2f642261bd9",
        "nl": false,
        "rap": true,
        "rh": 0,
        "x": 2960,
        "y": 400,
        "wires": [
            [
                "03dbe818c7eddb9f"
            ]
        ]
    },
    {
        "id": "fae5e3a9bf0ab117",
        "type": "mqtt in",
        "z": "d43d9cbcc461780f",
        "name": "",
        "topic": "II1/ESP3098241/switch/status",
        "qos": "2",
        "datatype": "auto",
        "broker": "0c8bf2f642261bd9",
        "nl": false,
        "rap": true,
        "rh": 0,
        "x": 4180,
        "y": 380,
        "wires": [
            [
                "179dc3cfe357bbce"
            ]
        ]
    },
    {
        "id": "32b3cb28389bb5cf",
        "type": "mqtt in",
        "z": "d43d9cbcc461780f",
        "name": "",
        "topic": "II1/ESP3098241/led/status",
        "qos": "2",
        "datatype": "auto",
        "broker": "0c8bf2f642261bd9",
        "nl": false,
        "rap": true,
        "rh": 0,
        "x": 4170,
        "y": 320,
        "wires": [
            [
                "179dc3cfe357bbce"
            ]
        ]
    },
    {
        "id": "7496b397eb3a3158",
        "type": "mqtt in",
        "z": "d43d9cbcc461780f",
        "name": "",
        "topic": "II1/ESP1128666/led/status",
        "qos": "2",
        "datatype": "auto",
        "broker": "0c8bf2f642261bd9",
        "nl": false,
        "rap": true,
        "rh": 0,
        "x": 4170,
        "y": 440,
        "wires": [
            [
                "179dc3cfe357bbce"
            ]
        ]
    },
    {
        "id": "38bdee26244d725f",
        "type": "mqtt in",
        "z": "d43d9cbcc461780f",
        "name": "",
        "topic": "II1/ESP1128666/switch/status",
        "qos": "2",
        "datatype": "auto",
        "broker": "0c8bf2f642261bd9",
        "nl": false,
        "rap": true,
        "rh": 0,
        "x": 4180,
        "y": 500,
        "wires": [
            [
                "179dc3cfe357bbce"
            ]
        ]
    },
    {
        "id": "b181f456ba7a6503",
        "type": "mqtt in",
        "z": "d43d9cbcc461780f",
        "name": "",
        "topic": "II1/ESP10796726/led/status",
        "qos": "2",
        "datatype": "auto",
        "broker": "0c8bf2f642261bd9",
        "nl": false,
        "rap": true,
        "rh": 0,
        "x": 4180,
        "y": 560,
        "wires": [
            [
                "179dc3cfe357bbce"
            ]
        ]
    },
    {
        "id": "cf8019291ece5823",
        "type": "mqtt in",
        "z": "d43d9cbcc461780f",
        "name": "",
        "topic": "II1/ESP10796726/switch/status",
        "qos": "2",
        "datatype": "auto",
        "broker": "0c8bf2f642261bd9",
        "nl": false,
        "rap": true,
        "rh": 0,
        "x": 4190,
        "y": 620,
        "wires": [
            [
                "179dc3cfe357bbce"
            ]
        ]
    },
    {
        "id": "5a80da7f559bfac3",
        "type": "comment",
        "z": "d43d9cbcc461780f",
        "name": "ALMACENAMIENTO ",
        "info": "",
        "x": 2790,
        "y": 120,
        "wires": []
    },
    {
        "id": "819fffb664b68673",
        "type": "http response",
        "z": "d43d9cbcc461780f",
        "name": "",
        "statusCode": "",
        "headers": {
            "Content-Disposition": "attachment; filename=Medidas_Sensores.csv"
        },
        "x": 4370,
        "y": 1080,
        "wires": []
    },
    {
        "id": "3690a9d8f73d3d68",
        "type": "function",
        "z": "d43d9cbcc461780f",
        "name": "Unicode y separador",
        "func": "//add Unicode BOM character (byte order mark) to make EXCEL knows this is UTF-8\nif(global.get(\"separador_decimal\")==\"punto\")\n{\n    msg.payload='\\ufeff'+msg.payload;\n\n}\nelse\n{\n    msg.payload='\\ufeff'+(msg.payload).replace(/\\./g,\",\");\n}\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 4200,
        "y": 1080,
        "wires": [
            [
                "819fffb664b68673"
            ]
        ]
    },
    {
        "id": "1e0a9bd7cbb24318",
        "type": "function",
        "z": "d43d9cbcc461780f",
        "name": "Consulta de los Sensores",
        "func": "// fecha por defecto es hoy\nvar ahora = new Date();\n// pillo los globales si los hay, si no la fecha de hoy\nvar desde = new Date(global.get(\"desde\") || ahora);\nvar hasta = new Date(global.get(\"hasta\") || ahora); \n// el día de inicio desde las cero horas\nvar inicio = new Date(desde.getFullYear(),desde.getMonth(),desde.getDate(),0,0,0,0);\n// el día final es hasta final del día\nvar final = new Date(hasta.getFullYear(),hasta.getMonth(),hasta.getDate(),23,59,59,999);\n\nvar placa = String(global.get(\"ID_PLACA\"));\n\nmsg.payload=\n[\n    { \"$match\": {$and:[ {\"date\": { \"$gte\": inicio , \"$lte\": final } },{\"CHIPID\":placa} ]}},\n   \n    { \"$project\": {\n        \"_id\": 0,\n        \"date\": 1,\n        \"Temperatura\": \"$DHT11.temp\",\n        \"Humedad\": \"$DHT11.hum\",\n        \"Vcc\": \"$Vcc\",\n        }\n    },\n    { \"$sort\": {\"date\": 1} }\n];\n\nreturn msg;\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 3490,
        "y": 1080,
        "wires": [
            [
                "59b6116dbaf66317"
            ]
        ]
    },
    {
        "id": "8fc916043634d8eb",
        "type": "http in",
        "z": "d43d9cbcc461780f",
        "name": "",
        "url": "/registros_sensores",
        "method": "get",
        "upload": false,
        "swaggerDoc": "",
        "x": 3210,
        "y": 1080,
        "wires": [
            [
                "1e0a9bd7cbb24318"
            ]
        ]
    },
    {
        "id": "af85fa4663d3591a",
        "type": "ui_template",
        "z": "d43d9cbcc461780f",
        "group": "a34ffe7a.04009",
        "name": "Sensores",
        "order": 5,
        "width": "0",
        "height": "0",
        "format": "<style>\n.button {\n    text-align: center;\n    font: bold 17px Arial;\n    text-decoration: none;\n    background-color: #339966;\n    color: white;\n    padding: 8px 10px;\n    border: 2px solid #CCCCCC;\n  }\n  \n  .button:hover\n  {\n   background-color: #26734d;\n  }\n\n</style>\n<a href=\"/registros_sensores\" class=\"button\">Descarga registro de sensores en CSV (EXCEL)</a>\n",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "resendOnRefresh": false,
        "templateScope": "local",
        "className": "",
        "x": 3170.0000228881836,
        "y": 934.9998197555542,
        "wires": [
            []
        ]
    },
    {
        "id": "9ab8c9060cbf8040",
        "type": "csv",
        "z": "d43d9cbcc461780f",
        "name": "",
        "sep": ";",
        "hdrin": "",
        "hdrout": "all",
        "multi": "one",
        "ret": "\\r\\n",
        "temp": "date,Temperatura, Humedad, Vcc",
        "skip": 0,
        "strings": true,
        "include_empty_strings": false,
        "include_null_values": false,
        "x": 4030,
        "y": 1080,
        "wires": [
            [
                "3690a9d8f73d3d68"
            ]
        ]
    },
    {
        "id": "c0763e2d40345b3c",
        "type": "ui_switch",
        "z": "d43d9cbcc461780f",
        "name": "separdor decimal",
        "label": "{{msg.topic}}",
        "tooltip": "",
        "group": "a34ffe7a.04009",
        "order": 4,
        "width": 0,
        "height": 0,
        "passthru": false,
        "decouple": "false",
        "topic": "",
        "style": "",
        "onvalue": "true",
        "onvalueType": "bool",
        "onicon": "",
        "oncolor": "",
        "offvalue": "false",
        "offvalueType": "bool",
        "officon": "",
        "offcolor": "",
        "x": 3250,
        "y": 1660,
        "wires": [
            [
                "7c5f833fedabf02d"
            ]
        ]
    },
    {
        "id": "20538a3f16dbfd7f",
        "type": "inject",
        "z": "d43d9cbcc461780f",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "true",
        "payloadType": "bool",
        "x": 3230.9970664978027,
        "y": 1582.9118814468384,
        "wires": [
            [
                "7c5f833fedabf02d"
            ]
        ]
    },
    {
        "id": "7c5f833fedabf02d",
        "type": "function",
        "z": "d43d9cbcc461780f",
        "name": "set global separador_decimal",
        "func": "if(msg.payload===true)\n{\n    global.set(\"separador_decimal\",\"coma\");\n    msg.topic=\"separador decimal = coma\";\n}\nelse\n{\n    global.set(\"separador_decimal\",\"punto\");\n    msg.topic=\"separador decimal = punto\";\n}\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 3559.0084533691406,
        "y": 1583.6192541122437,
        "wires": [
            [
                "c0763e2d40345b3c"
            ]
        ]
    },
    {
        "id": "a3fbc7ba633cce39",
        "type": "ui_date_picker",
        "z": "d43d9cbcc461780f",
        "name": "",
        "label": "Fecha inicio",
        "group": "a34ffe7a.04009",
        "order": 1,
        "width": 0,
        "height": 0,
        "passthru": true,
        "topic": "",
        "topicType": "str",
        "className": "",
        "x": 3390,
        "y": 1400,
        "wires": [
            [
                "db2e9e5b28f244c8"
            ]
        ]
    },
    {
        "id": "6bec0cf87e2e8234",
        "type": "ui_date_picker",
        "z": "d43d9cbcc461780f",
        "name": "",
        "label": "Fecha final",
        "group": "a34ffe7a.04009",
        "order": 2,
        "width": 0,
        "height": 0,
        "passthru": true,
        "topic": "",
        "x": 3393.0113525390625,
        "y": 1448.9942374229431,
        "wires": [
            [
                "83382e4d99f7692b"
            ]
        ]
    },
    {
        "id": "db2e9e5b28f244c8",
        "type": "change",
        "z": "d43d9cbcc461780f",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "desde",
                "pt": "global",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 3586.0056762695312,
        "y": 1398.6618876457214,
        "wires": [
            []
        ]
    },
    {
        "id": "83382e4d99f7692b",
        "type": "change",
        "z": "d43d9cbcc461780f",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "hasta",
                "pt": "global",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 3589.232955932617,
        "y": 1449.5454421043396,
        "wires": [
            []
        ]
    },
    {
        "id": "83251b68baf65a3c",
        "type": "inject",
        "z": "d43d9cbcc461780f",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 3192.008499145508,
        "y": 1424.420440196991,
        "wires": [
            [
                "a3fbc7ba633cce39",
                "6bec0cf87e2e8234"
            ]
        ]
    },
    {
        "id": "15cf8f42414ef5fc",
        "type": "comment",
        "z": "d43d9cbcc461780f",
        "name": "Controles para seleccionar fechas",
        "info": "",
        "x": 3249.008487701416,
        "y": 1327.8977246284485,
        "wires": []
    },
    {
        "id": "f394096642fb5e27",
        "type": "comment",
        "z": "d43d9cbcc461780f",
        "name": "Botón en HTML para lanzar descarga de fichero",
        "info": "",
        "x": 3279.789779663086,
        "y": 887.0822734832764,
        "wires": []
    },
    {
        "id": "b610ac7101b07e17",
        "type": "comment",
        "z": "d43d9cbcc461780f",
        "name": "Flujo para descarga de fichero los datos ",
        "info": "",
        "x": 3240,
        "y": 1020,
        "wires": []
    },
    {
        "id": "fdb18879e55b3728",
        "type": "comment",
        "z": "d43d9cbcc461780f",
        "name": "Selector de separador decimal",
        "info": "",
        "x": 3243.01123046875,
        "y": 1522.5740060806274,
        "wires": []
    },
    {
        "id": "30cb4287fa59cb62",
        "type": "http in",
        "z": "d43d9cbcc461780f",
        "name": "",
        "url": "/registros_conexion",
        "method": "get",
        "upload": false,
        "swaggerDoc": "",
        "x": 3210,
        "y": 1160,
        "wires": [
            [
                "e4ede052c734e487"
            ]
        ]
    },
    {
        "id": "e4ede052c734e487",
        "type": "function",
        "z": "d43d9cbcc461780f",
        "name": "Consulta de las Conexiones",
        "func": "// fecha por defecto es hoy\nvar ahora = new Date();\n// pillo los globales si los hay, si no la fecha de hoy\nvar desde = new Date(global.get(\"desde\") || ahora);\nvar hasta = new Date(global.get(\"hasta\") || ahora); \n// el día de inicio desde las cero horas\nvar inicio = new Date(desde.getFullYear(),desde.getMonth(),desde.getDate(),0,0,0,0);\n// el día final es hasta final del día\nvar final = new Date(hasta.getFullYear(),hasta.getMonth(),hasta.getDate(),23,59,59,999);\nvar placa = String(global.get(\"ID_PLACA\"));\nmsg.payload=\n[\n     { \"$match\": {$and:[ {\"date\": { \"$gte\": inicio , \"$lte\": final } },{\"CHIPID\":placa} ]}},\n    { \"$project\": {\n        \"_id\": 0,\n        \"date\": 1,\n        \"IP\": \"$Wifi.IP\",\n        \"SSId\": \"$Wifi.SSId\",\n        \"RSSI\": \"$Wifi.RSSI\",\n        }\n    },\n    { \"$sort\": {\"date\": 1} }\n];\n\nreturn msg;\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 3500,
        "y": 1160,
        "wires": [
            [
                "218c87d8f2fd731a"
            ]
        ]
    },
    {
        "id": "218c87d8f2fd731a",
        "type": "mongodb in",
        "z": "d43d9cbcc461780f",
        "mongodb": "3752afa1.deaf9",
        "name": "",
        "collection": "Proyecto1_Datos",
        "operation": "aggregate",
        "x": 3820,
        "y": 1160,
        "wires": [
            [
                "9b35388fa2a80a18"
            ]
        ]
    },
    {
        "id": "9b35388fa2a80a18",
        "type": "csv",
        "z": "d43d9cbcc461780f",
        "name": "",
        "sep": ";",
        "hdrin": "",
        "hdrout": "all",
        "multi": "one",
        "ret": "\\r\\n",
        "temp": "date,IP, SSId, RSSI",
        "skip": 0,
        "strings": true,
        "include_empty_strings": false,
        "include_null_values": false,
        "x": 4110,
        "y": 1160,
        "wires": [
            [
                "c829d4fa145be704"
            ]
        ]
    },
    {
        "id": "c829d4fa145be704",
        "type": "http response",
        "z": "d43d9cbcc461780f",
        "name": "",
        "statusCode": "",
        "headers": {
            "Content-Disposition": "attachment; filename=Conexiones.csv"
        },
        "x": 4250,
        "y": 1160,
        "wires": []
    },
    {
        "id": "857b6c823423d08c",
        "type": "ui_template",
        "z": "d43d9cbcc461780f",
        "group": "a34ffe7a.04009",
        "name": "Conexiones",
        "order": 6,
        "width": "0",
        "height": "0",
        "format": "<style>\n.button {\n    text-align: center;\n    font: bold 17px Arial;\n    text-decoration: none;\n    background-color: #339966;\n    color: white;\n    padding: 8px 10px;\n    border: 2px solid #CCCCCC;\n  }\n  \n  .button:hover\n  {\n   background-color: #26734d;\n  }\n\n</style>\n<a href=\"/registros_conexion\" class=\"button\">Descarga registro de conexiones en CSV (EXCEL)</a>\n",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "resendOnRefresh": false,
        "templateScope": "local",
        "className": "",
        "x": 3350,
        "y": 940,
        "wires": [
            []
        ]
    },
    {
        "id": "1ec15f58f7977adf",
        "type": "http in",
        "z": "d43d9cbcc461780f",
        "name": "",
        "url": "/registros_actuadores",
        "method": "get",
        "upload": false,
        "swaggerDoc": "",
        "x": 3210,
        "y": 1240,
        "wires": [
            [
                "db5615ed48be03d2"
            ]
        ]
    },
    {
        "id": "db5615ed48be03d2",
        "type": "function",
        "z": "d43d9cbcc461780f",
        "name": "Consulta de los Actuadores",
        "func": "// fecha por defecto es hoy\nvar ahora = new Date();\n// pillo los globales si los hay, si no la fecha de hoy\nvar desde = new Date(global.get(\"desde\") || ahora);\nvar hasta = new Date(global.get(\"hasta\") || ahora); \n// el día de inicio desde las cero horas\nvar inicio = new Date(desde.getFullYear(),desde.getMonth(),desde.getDate(),0,0,0,0);\n// el día final es hasta final del día\nvar final = new Date(hasta.getFullYear(),hasta.getMonth(),hasta.getDate(),23,59,59,999);\nvar placa = String(global.get(\"ID_PLACA\"));\n\nmsg.payload=\n[\n    { \"$match\": {$and:[ {\"date\": { \"$gte\": inicio , \"$lte\": final } },{\"CHIPID\":placa} ]}},\n    { \"$project\": {\n        \"_id\": 0,\n        \"date\": 1,\n        \"LED\": \"$LED\",\n        \"SWITCH\": \"$SWITCH\",\n        \"ORIGEN\": \"$origen\"\n        }\n    },\n    { \"$sort\": {\"date\": 1} }\n];\n\nreturn msg;\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 3500,
        "y": 1240,
        "wires": [
            [
                "26f32ea4c800a7f2"
            ]
        ]
    },
    {
        "id": "7011cf6b22c5984f",
        "type": "csv",
        "z": "d43d9cbcc461780f",
        "name": "",
        "sep": ";",
        "hdrin": "",
        "hdrout": "all",
        "multi": "one",
        "ret": "\\r\\n",
        "temp": "date,LED,SWITCH,ORIGEN",
        "skip": 0,
        "strings": true,
        "include_empty_strings": false,
        "include_null_values": false,
        "x": 4130,
        "y": 1240,
        "wires": [
            [
                "312b60b6a2bba7ba"
            ]
        ]
    },
    {
        "id": "312b60b6a2bba7ba",
        "type": "http response",
        "z": "d43d9cbcc461780f",
        "name": "",
        "statusCode": "",
        "headers": {
            "Content-Disposition": "attachment; filename=Actuadores.csv"
        },
        "x": 4270,
        "y": 1240,
        "wires": []
    },
    {
        "id": "62a217666af81b47",
        "type": "ui_template",
        "z": "d43d9cbcc461780f",
        "group": "a34ffe7a.04009",
        "name": "Actuadores",
        "order": 7,
        "width": "0",
        "height": "0",
        "format": "<style>\n.button {\n    text-align: center;\n    font: bold 17px Arial;\n    text-decoration: none;\n    background-color: #339966;\n    color: white;\n    padding: 8px 10px;\n    border: 2px solid #CCCCCC;\n  }\n  \n  .button:hover\n  {\n   background-color: #26734d;\n  }\n\n</style>\n<a href=\"/registros_actuadores\" class=\"button\">Descarga registro de los cambios actuadores en CSV (EXCEL)</a>\n",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "resendOnRefresh": false,
        "templateScope": "local",
        "className": "",
        "x": 3550,
        "y": 940,
        "wires": [
            []
        ]
    },
    {
        "id": "26f32ea4c800a7f2",
        "type": "mongodb in",
        "z": "d43d9cbcc461780f",
        "mongodb": "3752afa1.deaf9",
        "name": "",
        "collection": "Proyecto1_Actuadores",
        "operation": "aggregate",
        "x": 3840,
        "y": 1240,
        "wires": [
            [
                "7011cf6b22c5984f"
            ]
        ]
    },
    {
        "id": "59b6116dbaf66317",
        "type": "mongodb in",
        "z": "d43d9cbcc461780f",
        "mongodb": "3752afa1.deaf9",
        "name": "",
        "collection": "Proyecto1_Datos",
        "operation": "aggregate",
        "x": 3820,
        "y": 1080,
        "wires": [
            [
                "9ab8c9060cbf8040"
            ]
        ]
    },
    {
        "id": "e95b462422d0ad31",
        "type": "ui_dropdown",
        "z": "d43d9cbcc461780f",
        "name": "idESP",
        "label": "ESP:",
        "tooltip": "",
        "place": "seleccione un ESP",
        "group": "a34ffe7a.04009",
        "order": 3,
        "width": 0,
        "height": 0,
        "passthru": true,
        "multiple": false,
        "options": [
            {
                "label": "ESP3098241",
                "value": "ESP3098241",
                "type": "str"
            },
            {
                "label": "ESP9745759",
                "value": "ESP9745759",
                "type": "str"
            },
            {
                "label": "ESP1128666",
                "value": "ESP1128666",
                "type": "str"
            },
            {
                "label": "ESP10796726",
                "value": "ESP10796726",
                "type": "str"
            }
        ],
        "payload": "",
        "topic": "topic",
        "topicType": "msg",
        "className": "idESP",
        "x": 3150,
        "y": 1280,
        "wires": [
            [
                "1730196ad1d67a2a"
            ]
        ]
    },
    {
        "id": "1730196ad1d67a2a",
        "type": "change",
        "z": "d43d9cbcc461780f",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "ID_PLACA",
                "pt": "global",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 3360,
        "y": 1280,
        "wires": [
            []
        ]
    },
    {
        "id": "79193c0990e04c2c",
        "type": "comment",
        "z": "d43d9cbcc461780f",
        "name": "DESCARGA DE DATOS",
        "info": "",
        "x": 3040,
        "y": 820,
        "wires": []
    },
    {
        "id": "77a9100d8216f95f",
        "type": "function",
        "z": "d43d9cbcc461780f",
        "name": "mensaje bienvenida",
        "func": "if(msg.payload.content.substring(0,1)!=\"/\")\n{\n msg.payload.content=\"Hola \"+msg.originalMessage.chat.first_name+\"!! soy el bot del Proyecto IoT I. Antes de comenzar, ¿a qué placa desea acceder?\\n\\nPlaca 1: /ESP_3098241\\n\\nPlaca 2: /ESP_9745759\\n\\nPlaca 3: /ESP_1128666\\n\\nPlaca 4: /ESP_10796726\\n\\n\\n Si desea volver a comenzar utilice el comando /start\";\n return msg;\n}",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 3600,
        "y": 2060,
        "wires": [
            [
                "981ca1f0f0f65b47"
            ]
        ]
    },
    {
        "id": "27c14dd049db7d9f",
        "type": "telegram receiver",
        "z": "d43d9cbcc461780f",
        "name": "",
        "bot": "bba8b2693149435b",
        "saveDataDir": "",
        "filterCommands": true,
        "x": 3180,
        "y": 2060,
        "wires": [
            [
                "77a9100d8216f95f"
            ],
            []
        ]
    },
    {
        "id": "363f24abb8735ff9",
        "type": "telegram sender",
        "z": "d43d9cbcc461780f",
        "name": "",
        "bot": "bba8b2693149435b",
        "haserroroutput": false,
        "outputs": 1,
        "x": 4600,
        "y": 2540,
        "wires": [
            []
        ]
    },
    {
        "id": "bec106529281ddd2",
        "type": "telegram command",
        "z": "d43d9cbcc461780f",
        "name": "",
        "command": "/start",
        "description": "",
        "registercommand": false,
        "language": "",
        "scope": "default",
        "bot": "bba8b2693149435b",
        "strict": false,
        "hasresponse": true,
        "useregex": false,
        "removeregexcommand": false,
        "outputs": 2,
        "x": 3150,
        "y": 2140,
        "wires": [
            [
                "77a9100d8216f95f"
            ],
            []
        ]
    },
    {
        "id": "b9d10157b02805f2",
        "type": "telegram command",
        "z": "d43d9cbcc461780f",
        "name": "",
        "command": "/sensores",
        "description": "",
        "registercommand": false,
        "language": "",
        "scope": "default",
        "bot": "bba8b2693149435b",
        "strict": false,
        "hasresponse": true,
        "useregex": false,
        "removeregexcommand": false,
        "outputs": 2,
        "x": 3140,
        "y": 2380,
        "wires": [
            [
                "064340c4d9f97a84"
            ],
            []
        ]
    },
    {
        "id": "064340c4d9f97a84",
        "type": "function",
        "z": "d43d9cbcc461780f",
        "name": "mensaje explicativo",
        "func": "\n msg.payload.content=\"🌡 SENSORES 🌡\\n\\nPara conocer el estado actual de los sensores utilice el comando: \\n/estado_sensores\\n\\nPara conocer el valor medio en un intervalo determinado utilice: \\n/valor_det\\n\";\n return msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 3370,
        "y": 2380,
        "wires": [
            [
                "363f24abb8735ff9"
            ]
        ]
    },
    {
        "id": "112f7fc4f57b52cd",
        "type": "telegram command",
        "z": "d43d9cbcc461780f",
        "name": "",
        "command": "/estado_sensores",
        "description": "",
        "registercommand": false,
        "language": "",
        "scope": "default",
        "bot": "bba8b2693149435b",
        "strict": false,
        "hasresponse": true,
        "useregex": false,
        "removeregexcommand": false,
        "outputs": 2,
        "x": 3230,
        "y": 2520,
        "wires": [
            [
                "7e6aaa7efd21c87a",
                "b9ac6bafabf8960c"
            ],
            []
        ]
    },
    {
        "id": "4656638c4aa52d99",
        "type": "telegram command",
        "z": "d43d9cbcc461780f",
        "name": "",
        "command": "/actuadores",
        "description": "",
        "registercommand": false,
        "language": "",
        "scope": "default",
        "bot": "bba8b2693149435b",
        "strict": false,
        "hasresponse": true,
        "useregex": false,
        "removeregexcommand": false,
        "outputs": 2,
        "x": 3130,
        "y": 2960,
        "wires": [
            [
                "aca50aa667f61ab8"
            ],
            []
        ]
    },
    {
        "id": "aca50aa667f61ab8",
        "type": "function",
        "z": "d43d9cbcc461780f",
        "name": "mensaje explicativo",
        "func": "\n msg.payload.content=\"💡 ACTUADORES 💡\\n\\nPara poder conocer el estado de los actuadores utilice el comando: \\n/estado_actuadores\\n\\nPara modififcar el valor de algun actuador utilice el comando: \\n/mod_actuador\\n\";\n return msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 3510,
        "y": 2960,
        "wires": [
            [
                "033d6ef68202a77e"
            ]
        ]
    },
    {
        "id": "5494f8ca7059acfc",
        "type": "telegram command",
        "z": "d43d9cbcc461780f",
        "name": "",
        "command": "/estado_actuadores",
        "description": "",
        "registercommand": false,
        "language": "",
        "scope": "default",
        "bot": "bba8b2693149435b",
        "strict": false,
        "hasresponse": true,
        "useregex": false,
        "removeregexcommand": false,
        "outputs": 2,
        "x": 3170,
        "y": 3040,
        "wires": [
            [
                "2469c11172bb86b6"
            ],
            []
        ]
    },
    {
        "id": "f09337fb2acd7af7",
        "type": "function",
        "z": "d43d9cbcc461780f",
        "name": "Estado de actuadores",
        "func": "var led = msg.payload[0].LED;\nvar sww = String(msg.payload[0].SWITCH);\nmsg.payload = {};\nmsg.payload.chatId = global.get(\"chatId\");\nmsg.payload.type = \"message\";\nmsg.payload.content=\"El valor actual del LED es: \"+led+\"\\nEl estado actual del SWITCH es: \"+sww;\n return msg;\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 3980,
        "y": 3040,
        "wires": [
            [
                "033d6ef68202a77e"
            ]
        ]
    },
    {
        "id": "e40db717c2f39a16",
        "type": "telegram command",
        "z": "d43d9cbcc461780f",
        "name": "",
        "command": "/mod_actuador",
        "description": "",
        "registercommand": false,
        "language": "",
        "scope": "default",
        "bot": "bba8b2693149435b",
        "strict": false,
        "hasresponse": true,
        "useregex": false,
        "removeregexcommand": false,
        "outputs": 2,
        "x": 3240,
        "y": 3140,
        "wires": [
            [
                "f640326be19cfb12"
            ],
            []
        ]
    },
    {
        "id": "f640326be19cfb12",
        "type": "function",
        "z": "d43d9cbcc461780f",
        "name": "mensaje explicativo",
        "func": " var estado_led = global.get(\"led\");\n var estado_sw = global.get(\"sw\");\n var estado_switch;\n \n if (estado_sw == 1)\n {\n    estado_switch = \"ON\";\n    }else{ \n    estado_switch = \"OFF\";\n}\n msg.payload.content=\"El nivel actual del led es: \"+estado_led+\"\\n\\nEl estado actual del SWITCH es: \"+estado_switch+\"\\n\\nPara modificar el valor LED💡 utilice el comando /LED y seguidamente, introduzca el valor en porcentaje deseado.\\n\\nPor ejemplo: /LED 85\\n\\nPara modificar el valor del SWITCH 💡 utilice el comando /SWITCH y seguidamente, introduca el valor 0 o 1 para apagarlo o encenderlo respectivamente.\\n\\nPor ejemplo /SWITCH 1 \";\n return msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 3510,
        "y": 3140,
        "wires": [
            [
                "033d6ef68202a77e"
            ]
        ]
    },
    {
        "id": "f2b4032fa65a5e74",
        "type": "telegram sender",
        "z": "d43d9cbcc461780f",
        "name": "",
        "bot": "bba8b2693149435b",
        "haserroroutput": false,
        "outputs": 1,
        "x": 3580,
        "y": 3760,
        "wires": [
            []
        ]
    },
    {
        "id": "eba1857233f38bda",
        "type": "telegram command",
        "z": "d43d9cbcc461780f",
        "name": "",
        "command": "/LED",
        "description": "",
        "registercommand": false,
        "language": "",
        "scope": "default",
        "bot": "bba8b2693149435b",
        "strict": false,
        "hasresponse": true,
        "useregex": false,
        "removeregexcommand": false,
        "outputs": 2,
        "x": 3310,
        "y": 3220,
        "wires": [
            [
                "9d4678c7a4f0ec87"
            ],
            []
        ]
    },
    {
        "id": "9d4678c7a4f0ec87",
        "type": "function",
        "z": "d43d9cbcc461780f",
        "name": "Obtener valor del actuador",
        "func": "var est_led= parseInt(msg.payload.content);\nvar id = msg.payload.chatId;\nmsg.payload = {};\nif((est_led >= 0 ) && (est_led <= 100 ))\n{   \n    msg.payload.level = est_led;\n    msg.payload.id = id;\n}\nelse{\n\nmsg.payload.type = \"message\";\nmsg.payload.content = \"❌ Por favor introduzca un valor entre 0 y 100\";\n}\n\nmsg.payload.chatId = id;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 3640,
        "y": 3220,
        "wires": [
            [
                "033d6ef68202a77e",
                "cb9bc80ef929d7bd",
                "d029edda5fc1bccb",
                "39fa4b3485f4e3e8"
            ]
        ]
    },
    {
        "id": "53f2059c822d2d7b",
        "type": "telegram command",
        "z": "d43d9cbcc461780f",
        "name": "",
        "command": "/SWITCH",
        "description": "",
        "registercommand": false,
        "language": "",
        "scope": "default",
        "bot": "bba8b2693149435b",
        "strict": false,
        "hasresponse": true,
        "useregex": false,
        "removeregexcommand": false,
        "outputs": 2,
        "x": 3320,
        "y": 3300,
        "wires": [
            [
                "0ead43686ff1a3e6"
            ],
            []
        ]
    },
    {
        "id": "0ead43686ff1a3e6",
        "type": "function",
        "z": "d43d9cbcc461780f",
        "name": "Obtener valor del actuador",
        "func": "var est_sw= parseInt(msg.payload.content);\nvar id = msg.payload.chatId;\nmsg.payload = {};\nif((est_sw == 0 ) || (est_sw == 1 ))\n{ \n    msg.payload.level = est_sw;\n    msg.payload.id = id;\n}\nelse{\n\nmsg.payload.type = \"message\";\nmsg.payload.content = \"❌ Por favor introduzca o 0 o 1 para apagar o encender el SWITCH\";\n}\nmsg.payload.chatId = id;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 3640,
        "y": 3300,
        "wires": [
            [
                "033d6ef68202a77e",
                "dc4e8b67ee4a5e12",
                "592cd8cf3b25af0f",
                "9ed83f6b6e46f4dc"
            ]
        ]
    },
    {
        "id": "60b09da071d47321",
        "type": "telegram command",
        "z": "d43d9cbcc461780f",
        "name": "",
        "command": "/valor_det",
        "description": "",
        "registercommand": false,
        "language": "",
        "scope": "default",
        "bot": "bba8b2693149435b",
        "strict": false,
        "hasresponse": true,
        "useregex": false,
        "removeregexcommand": false,
        "outputs": 2,
        "x": 3240,
        "y": 2660,
        "wires": [
            [
                "0ac741d2d4227ade"
            ],
            []
        ]
    },
    {
        "id": "0ac741d2d4227ade",
        "type": "function",
        "z": "d43d9cbcc461780f",
        "name": "mensaje explicativo",
        "func": " msg.payload.content= \"Para conocer los datos de temperatura y humedad de los siguientes periodos, utilice los comandos asignados:\\n\\n⏱Número de horas previas hasta ahora: /horas + nº horas.\\n\\n📆Número de días previos hasta ahora: /dias + nº días.\\n\\n📅Número de semanas previas hasta ahora: /semanas + nº semanas.\\n\\nPor ejemplo: /dias 24\"\n return msg;\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 3590,
        "y": 2660,
        "wires": [
            [
                "363f24abb8735ff9"
            ]
        ]
    },
    {
        "id": "4170456ce09f5cb8",
        "type": "telegram command",
        "z": "d43d9cbcc461780f",
        "name": "",
        "command": "/horas",
        "description": "",
        "registercommand": false,
        "language": "",
        "scope": "default",
        "bot": "bba8b2693149435b",
        "strict": false,
        "hasresponse": true,
        "useregex": false,
        "removeregexcommand": false,
        "outputs": 2,
        "x": 3310,
        "y": 2760,
        "wires": [
            [
                "9235902c44800b49",
                "b9ac6bafabf8960c"
            ],
            []
        ]
    },
    {
        "id": "e7c6c8682909753c",
        "type": "telegram command",
        "z": "d43d9cbcc461780f",
        "name": "",
        "command": "/dias",
        "description": "",
        "registercommand": false,
        "language": "",
        "scope": "default",
        "bot": "bba8b2693149435b",
        "strict": false,
        "hasresponse": true,
        "useregex": false,
        "removeregexcommand": false,
        "outputs": 2,
        "x": 3310,
        "y": 2800,
        "wires": [
            [
                "20ec22dc209e3f93",
                "b9ac6bafabf8960c"
            ],
            []
        ]
    },
    {
        "id": "1aeb83215f5246ab",
        "type": "telegram command",
        "z": "d43d9cbcc461780f",
        "name": "",
        "command": "/semanas",
        "description": "",
        "registercommand": false,
        "language": "",
        "scope": "default",
        "bot": "bba8b2693149435b",
        "strict": false,
        "hasresponse": true,
        "useregex": false,
        "removeregexcommand": false,
        "outputs": 2,
        "x": 3320,
        "y": 2840,
        "wires": [
            [
                "8141bbeb735cb7ba",
                "b9ac6bafabf8960c"
            ],
            []
        ]
    },
    {
        "id": "508afe0cf8ca6048",
        "type": "function",
        "z": "d43d9cbcc461780f",
        "name": "Consulta dias",
        "func": "if (msg.payload.fecha >0)\n{\ndias = msg.payload.fecha;\n\nvar ms_per_minute = 60000;\n// obtiene el timestamp actual\nvar ahora = new Date().getTime();\n// crear objeto fecha con la hora de hace 12 horas\nvar fecha = new Date(ahora-60*dias*24*ms_per_minute);\n\nvar inicio = new Date(fecha.getFullYear(),fecha.getMonth(),fecha.getDate(),fecha.getHours());\nvar placa = global.get(\"placa_selec\");\nmsg.payload=\n[\n    { \"$match\": {$and:[ {\"date\": { \"$gte\": inicio } },{\"CHIPID\":placa} ]}},\n    { \"$project\": {\n        \"_id\": 0,\n        \"date\": 1,\n        \"Temperatura\": \"$DHT11.temp\",\n        \"Humedad\": \"$DHT11.hum\",\n        \"Vcc\": \"$Vcc\",\n        }\n    },\n    { \"$group\": {\n        \"_id\": 0,\n        \"Tmedia\":{\"$avg\":\"$Temperatura\"},\n        \"Tmax\":  {\"$max\":\"$Temperatura\"},\n        \"Tmin\":  {\"$min\":\"$Temperatura\"},\n        \"datos\": {\"$sum\":1},\n        \"Hmedia\":{\"$avg\":\"$Humedad\"},\n        \"Hmax\":  {\"$max\":\"$Humedad\"},\n        \"Hmin\":  {\"$min\":\"$Humedad\"}\n    }},\n    { \"$sort\": {\"date\": 1} }\n];\n\nreturn msg;\n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 3880,
        "y": 2800,
        "wires": [
            [
                "d4471b2312dd28ac"
            ]
        ]
    },
    {
        "id": "fd9d1827a2715fb7",
        "type": "function",
        "z": "d43d9cbcc461780f",
        "name": "Consulta semana",
        "func": "if (msg.payload.fecha >0)\n{\nsemanas = msg.payload.fecha;\n\nvar ms_per_minute = 60000;\n// obtiene el timestamp actual\nvar ahora = new Date().getTime();\n// crear objeto fecha con la hora de hace 12 horas\nvar semana = new Date(ahora-60*24*7*semanas*ms_per_minute);\n\nvar inicio = new Date(semana.getFullYear(),semana.getMonth(),semana.getDate(),semana.getHours());\nvar placa = global.get(\"placa_selec\");\n\n\nmsg.payload=\n[\n    { \"$match\": {$and:[ {\"date\": { \"$gte\": inicio } },{\"CHIPID\":placa} ]}},\n    { \"$project\": {\n        \"_id\": 0,\n        \"date\": 1,\n        \"Temperatura\": \"$DHT11.temp\",\n        \"Humedad\": \"$DHT11.hum\",\n        \"Vcc\": \"$Vcc\",\n        }\n    },\n    { \"$group\": {\n        \"_id\": 0,\n        \"Tmedia\":{\"$avg\":\"$Temperatura\"},\n        \"Tmax\":  {\"$max\":\"$Temperatura\"},\n        \"Tmin\":  {\"$min\":\"$Temperatura\"},\n        \"datos\": {\"$sum\":1},\n        \"Hmedia\":{\"$avg\":\"$Humedad\"},\n        \"Hmax\":  {\"$max\":\"$Humedad\"},\n        \"Hmin\":  {\"$min\":\"$Humedad\"}\n    }},\n    { \"$sort\": {\"date\": 1} }\n];\n\nreturn msg;\n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 3890,
        "y": 2840,
        "wires": [
            [
                "d4471b2312dd28ac"
            ]
        ]
    },
    {
        "id": "a104add2fa174410",
        "type": "function",
        "z": "d43d9cbcc461780f",
        "name": "Datos obtenidos",
        "func": "var TMed = msg.payload[0].Tmedia.toFixed(2);\nvar TMax = msg.payload[0].Tmax;\nvar TMin = msg.payload[0].Tmin;\n\nvar HMed = msg.payload[0].Hmedia.toFixed(2);\nvar HMax = msg.payload[0].Hmax;\nvar HMin = msg.payload[0].Hmin;\n\nvar datos = msg.payload[0].datos;\nvar placa = global.get(\"placa_selec\");\nmsg.payload = {};\nmsg.payload.chatId = global.get(\"chatId\");\nmsg.payload.type = \"message\";\nmsg.payload.content= \"📌TEMPERATURA\\n\\n📊Temperatura media: \"+TMed+\"ºC.\\n📈Temperatura máxima: \"+TMax+\"ºC.\\n📉Temperatura mínima: \"+TMin+\"ºC.\\n\\n📌HUMEDAD\\n\\n📊Humedad media: \"+HMed+\"%.\\n📈Humedad máxima: \"+HMax+\"%.\\n📉Humedad mínima: \"+HMin+\"%.\\n\\nSe han tomado \"+datos+\" datos hasta la fecha.\\n\\nPlaca: \"+placa+\"📲\";\n \n return msg;\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 4420,
        "y": 2800,
        "wires": [
            [
                "363f24abb8735ff9"
            ]
        ]
    },
    {
        "id": "bdcc7a026faf2825",
        "type": "function",
        "z": "d43d9cbcc461780f",
        "name": "Consulta horas",
        "func": "if (msg.payload.fecha >0)\n{\nhoras = msg.payload.fecha;\nmsg.payload = {};\n\nvar ms_per_minute = 60000;\n// obtiene el timestamp actual\nvar ahora = new Date().getTime();\n// crear objeto fecha con la hora de hace 12 horas\nvar fecha = new Date(ahora-60*horas*ms_per_minute);\n\nvar inicio = new Date(fecha.getFullYear(),fecha.getMonth(),fecha.getDate(),fecha.getHours());\nvar placa = global.get(\"placa_selec\");\nmsg.payload=\n[\n    { \"$match\": {$and:[ {\"date\": { \"$gte\": inicio } },{\"CHIPID\":placa} ]}},\n    { \"$project\": {\n        \"_id\": 0,\n        \"date\": 1,\n        \"Temperatura\": \"$DHT11.temp\",\n        \"Humedad\": \"$DHT11.hum\",\n        \"Vcc\": \"$Vcc\",\n        }\n    },\n    { \"$group\": {\n        \"_id\": 0,\n        \"Tmedia\":{\"$avg\":\"$Temperatura\"},\n        \"Tmax\":  {\"$max\":\"$Temperatura\"},\n        \"Tmin\":  {\"$min\":\"$Temperatura\"},\n        \"datos\": {\"$sum\":1},\n        \"Hmedia\":{\"$avg\":\"$Humedad\"},\n        \"Hmax\":  {\"$max\":\"$Humedad\"},\n        \"Hmin\":  {\"$min\":\"$Humedad\"}\n    }},\n    { \"$sort\": {\"date\": 1} }\n];\n\nreturn msg;\n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 3880,
        "y": 2760,
        "wires": [
            [
                "d4471b2312dd28ac"
            ]
        ]
    },
    {
        "id": "033d6ef68202a77e",
        "type": "telegram sender",
        "z": "d43d9cbcc461780f",
        "name": "",
        "bot": "bba8b2693149435b",
        "haserroroutput": false,
        "outputs": 1,
        "x": 4620,
        "y": 3020,
        "wires": [
            []
        ]
    },
    {
        "id": "75981113356690bc",
        "type": "telegram sender",
        "z": "d43d9cbcc461780f",
        "name": "",
        "bot": "bba8b2693149435b",
        "haserroroutput": false,
        "outputs": 1,
        "x": 3900,
        "y": 2680,
        "wires": [
            []
        ]
    },
    {
        "id": "20ec22dc209e3f93",
        "type": "function",
        "z": "d43d9cbcc461780f",
        "name": "Obtener valor de dias",
        "func": "var fecha= parseInt(msg.payload.content);\nvar id = msg.payload.chatId;\nmsg.payload = {};\nif(fecha > 0)\n{ \n    msg.payload.fecha = fecha;\n\n}\nelse{\nmsg.payload = {};\nmsg.payload.type = \"message\";\nmsg.payload.content = \"❌Por favor introduzca un valor correcto\";\n}\n\nmsg.payload.chatId = id;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 3540,
        "y": 2800,
        "wires": [
            [
                "508afe0cf8ca6048",
                "75981113356690bc"
            ]
        ]
    },
    {
        "id": "9235902c44800b49",
        "type": "function",
        "z": "d43d9cbcc461780f",
        "name": "Obtener valor de horas",
        "func": "var fecha= parseInt(msg.payload.content);\nvar id = msg.payload.chatId;\n\nmsg.payload = {};\nif(fecha > 0 )\n{ \n    msg.payload.fecha = fecha;\n\n}\nelse{\n\nmsg.payload.type = \"message\";\nmsg.payload.content = \"❌Por favor introduzca un valor correcto\";\n\n}\n\nmsg.payload.chatId = id;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 3550,
        "y": 2760,
        "wires": [
            [
                "bdcc7a026faf2825",
                "75981113356690bc"
            ]
        ]
    },
    {
        "id": "8141bbeb735cb7ba",
        "type": "function",
        "z": "d43d9cbcc461780f",
        "name": "Obtener valor de semanas",
        "func": "var fecha= parseInt(msg.payload.content);\nmsg.payload = {};\nif(fecha > 0 )\n{ \n    msg.payload.fecha = fecha;\n return msg;\n}\nelse{\n    msg.payload = {};\nmsg.payload.type = \"message\";\nmsg.payload.content = \"❌Por favor introduzca un valor correcto\";\nreturn msg;\n};",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 3560,
        "y": 2840,
        "wires": [
            [
                "fd9d1827a2715fb7",
                "75981113356690bc"
            ]
        ]
    },
    {
        "id": "d4471b2312dd28ac",
        "type": "mongodb in",
        "z": "d43d9cbcc461780f",
        "mongodb": "3752afa1.deaf9",
        "name": "",
        "collection": "Proyecto1_Datos",
        "operation": "aggregate",
        "x": 4180,
        "y": 2800,
        "wires": [
            [
                "a104add2fa174410"
            ]
        ]
    },
    {
        "id": "cb9bc80ef929d7bd",
        "type": "function",
        "z": "d43d9cbcc461780f",
        "name": "Number to JSON",
        "func": "var led_level=msg.payload.level;\nvar id = msg.payload.id;\n\nvar data={\"level\":led_level, \"id\": String(id)};\nnode.log(typeof data);\nmsg.payload= JSON.stringify(data);\nmsg.topic = \"II1/\"+String(global.get(\"placa_selec\"))+\"/led/cmd\";\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 4010,
        "y": 3200,
        "wires": [
            [
                "d34e22563b178458"
            ]
        ]
    },
    {
        "id": "d34e22563b178458",
        "type": "mqtt out",
        "z": "d43d9cbcc461780f",
        "name": "",
        "topic": "",
        "qos": "",
        "retain": "",
        "respTopic": "",
        "contentType": "",
        "userProps": "",
        "correl": "",
        "expiry": "",
        "broker": "d33925125a47f633",
        "x": 4190,
        "y": 3220,
        "wires": []
    },
    {
        "id": "dc4e8b67ee4a5e12",
        "type": "function",
        "z": "d43d9cbcc461780f",
        "name": "Number to JSON",
        "func": "var led_level=msg.payload.level;\nvar id = msg.payload.id;\n\nvar data={\"level\":led_level, \"id\": String(id)};\nnode.log(typeof data);\nmsg.payload= JSON.stringify(data);\nmsg.topic = \"II1/\"+global.get(\"placa_selec\")+\"/switch/cmd\";\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 4010,
        "y": 3240,
        "wires": [
            [
                "d34e22563b178458"
            ]
        ]
    },
    {
        "id": "b9ac6bafabf8960c",
        "type": "change",
        "z": "d43d9cbcc461780f",
        "name": "chatId",
        "rules": [
            {
                "t": "set",
                "p": "chatId",
                "pt": "global",
                "to": "payload.chatId",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 3490,
        "y": 2880,
        "wires": [
            []
        ]
    },
    {
        "id": "6745aa64d00a7efe",
        "type": "comment",
        "z": "d43d9cbcc461780f",
        "name": "Obtención del id del chat para el envio de datos",
        "info": "",
        "x": 3760,
        "y": 2880,
        "wires": []
    },
    {
        "id": "2ea3a3d299e9fae5",
        "type": "comment",
        "z": "d43d9cbcc461780f",
        "name": "TELEGRAM",
        "info": "",
        "x": 2950,
        "y": 1940,
        "wires": []
    },
    {
        "id": "61e7e81648ef3319",
        "type": "comment",
        "z": "d43d9cbcc461780f",
        "name": "ID del canal : -1001705665908",
        "info": "",
        "x": 4090,
        "y": 3740,
        "wires": []
    },
    {
        "id": "af32133782aeb3d0",
        "type": "telegram command",
        "z": "d43d9cbcc461780f",
        "name": "",
        "command": "/ESP_3098241",
        "description": "",
        "registercommand": false,
        "language": "",
        "scope": "default",
        "bot": "bba8b2693149435b",
        "strict": false,
        "hasresponse": true,
        "useregex": false,
        "removeregexcommand": false,
        "outputs": 2,
        "x": 3300,
        "y": 2200,
        "wires": [
            [
                "c9b81413f78e620f"
            ],
            []
        ]
    },
    {
        "id": "103114089dedeb8e",
        "type": "telegram command",
        "z": "d43d9cbcc461780f",
        "name": "",
        "command": "/ESP_9745759",
        "description": "",
        "registercommand": false,
        "language": "",
        "scope": "default",
        "bot": "bba8b2693149435b",
        "strict": false,
        "hasresponse": true,
        "useregex": false,
        "removeregexcommand": false,
        "outputs": 2,
        "x": 3480,
        "y": 2200,
        "wires": [
            [
                "46dd7ae82bb76fea"
            ],
            []
        ]
    },
    {
        "id": "9c942f119e3792c2",
        "type": "telegram command",
        "z": "d43d9cbcc461780f",
        "name": "",
        "command": "/ESP_1128666",
        "description": "",
        "registercommand": false,
        "language": "",
        "scope": "default",
        "bot": "bba8b2693149435b",
        "strict": false,
        "hasresponse": true,
        "useregex": false,
        "removeregexcommand": false,
        "outputs": 2,
        "x": 3660,
        "y": 2200,
        "wires": [
            [
                "dce2361ba0e37ce2"
            ],
            []
        ]
    },
    {
        "id": "8dcdc61660cc072f",
        "type": "telegram command",
        "z": "d43d9cbcc461780f",
        "name": "",
        "command": "/ESP_10796726",
        "description": "",
        "registercommand": false,
        "language": "",
        "scope": "default",
        "bot": "bba8b2693149435b",
        "strict": false,
        "hasresponse": true,
        "useregex": false,
        "removeregexcommand": false,
        "outputs": 2,
        "x": 3860,
        "y": 2200,
        "wires": [
            [
                "5ea941903b7dbb2c"
            ],
            []
        ]
    },
    {
        "id": "c9b81413f78e620f",
        "type": "function",
        "z": "d43d9cbcc461780f",
        "name": "",
        "func": "\nmsg.payload.placa = \"ESP3098241\";\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 3430,
        "y": 2140,
        "wires": [
            [
                "75a80f32908d636c"
            ]
        ]
    },
    {
        "id": "46dd7ae82bb76fea",
        "type": "function",
        "z": "d43d9cbcc461780f",
        "name": "",
        "func": "\nmsg.payload.placa = \"ESP9745759\";\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 3600,
        "y": 2140,
        "wires": [
            [
                "75a80f32908d636c"
            ]
        ]
    },
    {
        "id": "dce2361ba0e37ce2",
        "type": "function",
        "z": "d43d9cbcc461780f",
        "name": "",
        "func": "\nmsg.payload.placa = \"ESP1128666\";\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 3760,
        "y": 2140,
        "wires": [
            [
                "75a80f32908d636c"
            ]
        ]
    },
    {
        "id": "5ea941903b7dbb2c",
        "type": "function",
        "z": "d43d9cbcc461780f",
        "name": "",
        "func": "\nmsg.payload.placa = \"ESP10796726\";\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 3920,
        "y": 2140,
        "wires": [
            [
                "75a80f32908d636c"
            ]
        ]
    },
    {
        "id": "75a80f32908d636c",
        "type": "change",
        "z": "d43d9cbcc461780f",
        "name": "placa_selec",
        "rules": [
            {
                "t": "set",
                "p": "placa_selec",
                "pt": "global",
                "to": "payload.placa",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 4150,
        "y": 2080,
        "wires": [
            [
                "bc5a890234c88ff9"
            ]
        ]
    },
    {
        "id": "981ca1f0f0f65b47",
        "type": "telegram sender",
        "z": "d43d9cbcc461780f",
        "name": "",
        "bot": "bba8b2693149435b",
        "haserroroutput": false,
        "outputs": 1,
        "x": 3880,
        "y": 2060,
        "wires": [
            []
        ]
    },
    {
        "id": "bc5a890234c88ff9",
        "type": "function",
        "z": "d43d9cbcc461780f",
        "name": "Información:",
        "func": "var placa = global.get(\"placa_selec\");\n\nif(msg.payload.content.substring(0,1)!=\"/\")\n{\n msg.payload.content=\"📲: \"+placa+\"\\n\\n🌡Para conocer el estado de los sensores utilice el comando /sensores\\n\\n💡Para modificar o consultar los actuadores utilice el comando /actuadores.\\n\\n🚦Para programar una alarma utilice el comando /alarma\";\n return msg;\n}",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 4330,
        "y": 2080,
        "wires": [
            [
                "0d716e9e2d0b6580"
            ]
        ]
    },
    {
        "id": "d2115d0f21d2c8bc",
        "type": "mongodb in",
        "z": "d43d9cbcc461780f",
        "mongodb": "3752afa1.deaf9",
        "name": "",
        "collection": "Proyecto1_Datos",
        "operation": "aggregate",
        "x": 3820,
        "y": 2520,
        "wires": [
            [
                "75e8661dc1a92947"
            ]
        ]
    },
    {
        "id": "7e6aaa7efd21c87a",
        "type": "function",
        "z": "d43d9cbcc461780f",
        "name": "Consulta Actual",
        "func": "var placa = global.get(\"placa_selec\");\nmsg.payload=\n[\n    { \"$match\": {\"CHIPID\":placa} },\n   \n    { \"$project\": {\n        \"_id\": 0,\n        \"date\":1,\n        \"Temperatura\": \"$DHT11.temp\",\n        \"Humedad\": \"$DHT11.hum\",\n        }\n    },\n    { \"$sort\": {\"date\": -1} },\n    {\"$limit\" : 1}\n];\n\nreturn msg;\n\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 3520,
        "y": 2520,
        "wires": [
            [
                "d2115d0f21d2c8bc"
            ]
        ]
    },
    {
        "id": "75e8661dc1a92947",
        "type": "function",
        "z": "d43d9cbcc461780f",
        "name": "Datos obtenidos",
        "func": "var Temp = msg.payload[0].Temperatura;\nvar Hum = msg.payload[0].Humedad;\n\nmsg.payload = {};\nmsg.payload.chatId = global.get(\"chatId\");\nmsg.payload.type = \"message\";\nmsg.payload.content= \"📍La temperatura actual es de \"+Temp+\"ºC.\\n\\n📍La humedad actual es de \"+Hum+\"%.\";\n \n return msg;\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 4120,
        "y": 2520,
        "wires": [
            [
                "363f24abb8735ff9"
            ]
        ]
    },
    {
        "id": "2469c11172bb86b6",
        "type": "function",
        "z": "d43d9cbcc461780f",
        "name": "Consulta Actual",
        "func": "var placa = global.get(\"placa_selec\");\nmsg.payload=\n[\n    { \"$match\": {\"CHIPID\":placa} },\n   \n    { \"$project\": {\n        \"_id\": 0,\n        \"date\":1,\n        \"LED\": \"$LED\",\n        \"SWITCH\": \"$SWITCH\",\n        }\n    },\n    { \"$sort\": {\"date\": -1} },\n    {\"$limit\" : 1}\n];\n\nreturn msg;\n\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 3440,
        "y": 3040,
        "wires": [
            [
                "225238c30a403d4d"
            ]
        ]
    },
    {
        "id": "225238c30a403d4d",
        "type": "mongodb in",
        "z": "d43d9cbcc461780f",
        "mongodb": "3752afa1.deaf9",
        "name": "",
        "collection": "Proyecto1_Datos",
        "operation": "aggregate",
        "x": 3680,
        "y": 3040,
        "wires": [
            [
                "f09337fb2acd7af7"
            ]
        ]
    },
    {
        "id": "d029edda5fc1bccb",
        "type": "function",
        "z": "d43d9cbcc461780f",
        "name": "Consulta Actual",
        "func": "var placa = global.get(\"placa_selec\");\nmsg.payload=\n[\n    { \"$match\": {\"CHIPID\":placa} },\n   \n    { \"$project\": {\n        \"_id\": 0,\n        \"date\":1,\n        \"LED\": \"$LED\",\n        \"SWITCH\": \"$SWITCH\",\n        }\n    },\n    { \"$sort\": {\"date\": -1} },\n    {\"$limit\" : 1}\n];\n\nreturn msg;\n\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 3980,
        "y": 3320,
        "wires": [
            [
                "430a1498b59ee506"
            ]
        ]
    },
    {
        "id": "430a1498b59ee506",
        "type": "mongodb in",
        "z": "d43d9cbcc461780f",
        "mongodb": "3752afa1.deaf9",
        "name": "",
        "collection": "Proyecto1_Datos",
        "operation": "aggregate",
        "x": 4220,
        "y": 3320,
        "wires": [
            [
                "b27dc5f826c0169a"
            ]
        ]
    },
    {
        "id": "b27dc5f826c0169a",
        "type": "function",
        "z": "d43d9cbcc461780f",
        "name": "Estado de actuadores",
        "func": "var led = msg.payload[0].LED;\nmsg.payload = {};\n\nmsg.payload.led = led;\n return msg;\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 4500,
        "y": 3320,
        "wires": [
            [
                "46f6fea0c2f1ecc5"
            ]
        ]
    },
    {
        "id": "592cd8cf3b25af0f",
        "type": "function",
        "z": "d43d9cbcc461780f",
        "name": "Consulta Actual",
        "func": "var placa = global.get(\"placa_selec\");\nmsg.payload=\n[\n    { \"$match\": {\"CHIPID\":placa} },\n   \n    { \"$project\": {\n        \"_id\": 0,\n        \"date\":1,\n        \"LED\": \"$LED\",\n        \"SWITCH\": \"$SWITCH\",\n        }\n    },\n    { \"$sort\": {\"date\": -1} },\n    {\"$limit\" : 1}\n];\n\nreturn msg;\n\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 3980,
        "y": 3400,
        "wires": [
            [
                "94b44f53c3797424"
            ]
        ]
    },
    {
        "id": "94b44f53c3797424",
        "type": "mongodb in",
        "z": "d43d9cbcc461780f",
        "mongodb": "3752afa1.deaf9",
        "name": "",
        "collection": "Proyecto1_Datos",
        "operation": "aggregate",
        "x": 4220,
        "y": 3400,
        "wires": [
            [
                "2ff6a503e80ec386"
            ]
        ]
    },
    {
        "id": "2ff6a503e80ec386",
        "type": "function",
        "z": "d43d9cbcc461780f",
        "name": "Estado de actuadores",
        "func": "var sw = msg.payload[0].SWITCH;\nmsg.payload = {};\n\nmsg.payload.sw = sw;\n return msg;\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 4500,
        "y": 3400,
        "wires": [
            [
                "792e21d6176a274d"
            ]
        ]
    },
    {
        "id": "39fa4b3485f4e3e8",
        "type": "function",
        "z": "d43d9cbcc461780f",
        "name": "Aviso cambio del LED",
        "func": "var cambio = msg.payload.level;\nvar actual = global.get(\"LED\");\nif ((cambio >= 0)&&(cambio <= 100))\n{\nif (cambio != actual)\n{\nmsg.payload.type = \"message\";\nmsg.payload.content = \"Modificación de la intensidad del LED💡 de la placa \"+global.get(\"placa_selec\")+\"\\n\\nCambio del \"+actual+\"%, al \"+cambio+\"%\";\nmsg.payload.chatId = String(-1001705665908) ;\nreturn msg;\n}}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 4000,
        "y": 3540,
        "wires": [
            [
                "a3f5927d362c6ebe"
            ]
        ]
    },
    {
        "id": "9ed83f6b6e46f4dc",
        "type": "function",
        "z": "d43d9cbcc461780f",
        "name": "Aviso cambio del SWITCH",
        "func": "var cambio = msg.payload.level;\nvar actual = global.get(\"SWITCH\");\nvar cambio_sw;\nif ((cambio == 1) || (cambio ==0))\n{\nif (cambio != actual)\n{\n    \nmsg.payload.type = \"message\";\nmsg.payload.content = \" Modificación del SWITCH💡 de la placa: \"+global.get(\"placa_selec\")+\"\\n\\nEstado actual: \"+String(cambio_sw)+\" \";\nmsg.payload.chatId = String(-1001705665908) ;\nreturn msg;\n}}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 4020,
        "y": 3580,
        "wires": [
            [
                "a3f5927d362c6ebe"
            ]
        ]
    },
    {
        "id": "a3f5927d362c6ebe",
        "type": "telegram sender",
        "z": "d43d9cbcc461780f",
        "name": "",
        "bot": "bba8b2693149435b",
        "haserroroutput": false,
        "outputs": 1,
        "x": 4320,
        "y": 3580,
        "wires": [
            []
        ]
    },
    {
        "id": "46f6fea0c2f1ecc5",
        "type": "change",
        "z": "d43d9cbcc461780f",
        "name": "LED",
        "rules": [
            {
                "t": "set",
                "p": "LED",
                "pt": "global",
                "to": "payload.led",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 4710,
        "y": 3320,
        "wires": [
            []
        ]
    },
    {
        "id": "792e21d6176a274d",
        "type": "change",
        "z": "d43d9cbcc461780f",
        "name": "SWITCH",
        "rules": [
            {
                "t": "set",
                "p": "SWITCH",
                "pt": "global",
                "to": "payload.sw",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 4720,
        "y": 3400,
        "wires": [
            []
        ]
    },
    {
        "id": "5aa5f083ed7f479f",
        "type": "function",
        "z": "d43d9cbcc461780f",
        "name": "Información:",
        "func": "\nmsg.payload.content = \"🔔 NOTIFICACIONES DE TEMPERATURAS 🔔\\n\\nPara recibir una notificación cuando la temperatura supere un máximo, utilice /tmax + temperatura.\\n\\nPara recibir una notificación cuando la temperatura esté por debajo de un mínimo, utilice /tmin + temperatura.\\n\\n\\n🔔 NOTIFICACIONES DE HUMEDAD 🔔\\n\\nPara recibir una notificación cuando la humedad supere un máximo, utilice /hmax + porcentaje.\\n\\nPara recibir una notificación cuando la humedad esté por debajo de un mínimo, utilice /hmin + porcentaje.\";\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 3390,
        "y": 3760,
        "wires": [
            [
                "f2b4032fa65a5e74"
            ]
        ]
    },
    {
        "id": "a9df8d7d55fc8435",
        "type": "telegram command",
        "z": "d43d9cbcc461780f",
        "name": "",
        "command": "/alarma",
        "description": "",
        "registercommand": false,
        "language": "",
        "scope": "default",
        "bot": "bba8b2693149435b",
        "strict": false,
        "hasresponse": true,
        "useregex": false,
        "removeregexcommand": false,
        "outputs": 2,
        "x": 3230,
        "y": 3760,
        "wires": [
            [
                "5aa5f083ed7f479f"
            ],
            []
        ]
    },
    {
        "id": "7d5e5566ac12902f",
        "type": "telegram command",
        "z": "d43d9cbcc461780f",
        "name": "",
        "command": "/tmin",
        "description": "",
        "registercommand": false,
        "language": "",
        "scope": "default",
        "bot": "bba8b2693149435b",
        "strict": false,
        "hasresponse": true,
        "useregex": false,
        "removeregexcommand": false,
        "outputs": 2,
        "x": 3250,
        "y": 3880,
        "wires": [
            [
                "568dc6889089d89a"
            ],
            []
        ]
    },
    {
        "id": "1b55062ad74574c3",
        "type": "telegram command",
        "z": "d43d9cbcc461780f",
        "name": "",
        "command": "/tmax",
        "description": "",
        "registercommand": false,
        "language": "",
        "scope": "default",
        "bot": "bba8b2693149435b",
        "strict": false,
        "hasresponse": true,
        "useregex": false,
        "removeregexcommand": false,
        "outputs": 2,
        "x": 3250,
        "y": 3840,
        "wires": [
            [
                "eb3dc2321f91fd51"
            ],
            []
        ]
    },
    {
        "id": "eb3dc2321f91fd51",
        "type": "function",
        "z": "d43d9cbcc461780f",
        "name": "Obtener valor tmax",
        "func": "var temp= parseInt(msg.payload.content);\nvar id = msg.payload.chatId;\nmsg.payload = {};\n \n    msg.payload.tmax = temp;\n\n\nmsg.payload.chatId = id;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 3430,
        "y": 3840,
        "wires": [
            [
                "5f917d85769dea8b",
                "d1c745d1965ff89a"
            ]
        ]
    },
    {
        "id": "568dc6889089d89a",
        "type": "function",
        "z": "d43d9cbcc461780f",
        "name": "Obtener valor tmin",
        "func": "var temp= parseFloat(msg.payload.content);\nvar id = msg.payload.chatId;\nmsg.payload = {};\n\n    msg.payload.tmin = temp;\n\nmsg.payload.chatId = id;\nreturn msg;\n\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 3430,
        "y": 3880,
        "wires": [
            [
                "13028e794d469618",
                "d1c745d1965ff89a"
            ]
        ]
    },
    {
        "id": "5f917d85769dea8b",
        "type": "change",
        "z": "d43d9cbcc461780f",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "temp_max",
                "pt": "flow",
                "to": "payload.tmax",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 3650,
        "y": 3840,
        "wires": [
            []
        ]
    },
    {
        "id": "13028e794d469618",
        "type": "change",
        "z": "d43d9cbcc461780f",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "temp_min",
                "pt": "flow",
                "to": "payload.tmin",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 3650,
        "y": 3880,
        "wires": [
            []
        ]
    },
    {
        "id": "d1c745d1965ff89a",
        "type": "function",
        "z": "d43d9cbcc461780f",
        "name": "Información:",
        "func": "msg.payload.content = \"Alarma configurada correctamente.\";\nmsg.payload.type = \"message\";\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 3830,
        "y": 3920,
        "wires": [
            [
                "db65d201dee63c19"
            ]
        ]
    },
    {
        "id": "0d716e9e2d0b6580",
        "type": "telegram sender",
        "z": "d43d9cbcc461780f",
        "name": "",
        "bot": "bba8b2693149435b",
        "haserroroutput": false,
        "outputs": 1,
        "x": 4520,
        "y": 2080,
        "wires": [
            []
        ]
    },
    {
        "id": "db65d201dee63c19",
        "type": "telegram sender",
        "z": "d43d9cbcc461780f",
        "name": "",
        "bot": "bba8b2693149435b",
        "haserroroutput": false,
        "outputs": 1,
        "x": 4240,
        "y": 3920,
        "wires": [
            []
        ]
    },
    {
        "id": "fa3cf6c78e8392ed",
        "type": "inject",
        "z": "d43d9cbcc461780f",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "payload"
            }
        ],
        "repeat": "30",
        "crontab": "",
        "once": true,
        "onceDelay": "30",
        "topic": "",
        "payload": "1",
        "payloadType": "num",
        "x": 3190,
        "y": 4120,
        "wires": [
            [
                "d183490385e35073"
            ]
        ]
    },
    {
        "id": "2fc75dfdbe4fde61",
        "type": "comment",
        "z": "d43d9cbcc461780f",
        "name": "Comprobacion de Temperaturas límites",
        "info": "",
        "x": 3170,
        "y": 4080,
        "wires": []
    },
    {
        "id": "d183490385e35073",
        "type": "function",
        "z": "d43d9cbcc461780f",
        "name": "Consulta Temperaturas",
        "func": "if(msg.payload ==1)\n{\nvar placa = global.get(\"placa_selec\");\nmsg.payload=\n[\n   \n    { \"$project\": {\n        \"_id\": 0,\n        \"date\":1,\n        \"Temperatura\": \"$DHT11.temp\",\n        \"CHIPID\": \"$CHIPID\",\n        \"Humedad\":\"$DTH11.hum\",\n        }\n    },\n    { \"$sort\": {\"date\": -1} },\n    {\"$limit\" : 1}\n];\n\nreturn msg;\n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 3430,
        "y": 4120,
        "wires": [
            [
                "8f38728ccbbd5b4c"
            ]
        ]
    },
    {
        "id": "8f38728ccbbd5b4c",
        "type": "mongodb in",
        "z": "d43d9cbcc461780f",
        "mongodb": "3752afa1.deaf9",
        "name": "",
        "collection": "Proyecto1_Datos",
        "operation": "aggregate",
        "x": 3780,
        "y": 4120,
        "wires": [
            [
                "23750bd8477dafa7"
            ]
        ]
    },
    {
        "id": "23750bd8477dafa7",
        "type": "function",
        "z": "d43d9cbcc461780f",
        "name": "Comprobación",
        "func": "var Temp = msg.payload[0].Temperatura;\nvar PLACA = msg.payload[0].CHIPID;\nvar Hum = msg.payload[0].Humedad;\n\nvar ms_per_minute = 60000;\n// obtiene el timestamp actual\nvar ahora = new Date().getTime();\n// crear objeto fecha con la hora de hace 12 horas\nvar fecha = new Date(ahora - ms_per_minute);\n\nvar inicio = new Date(fecha.getFullYear(),fecha.getMonth(),fecha.getDate(),fecha.getHours());\n\nif (msg.payload[0].date >= inicio) //Para que no compruebe fechas pasadas\n{\nif (Temp > flow.get(\"temp_max\"))\n{\nmsg.payload = {};\nmsg.payload.chatId = -1001705665908;\nmsg.payload.type = \"message\";\nmsg.payload.content= \"⚠️ TEMPERATURA POR ENCIMA DEL LÍMITE ⚠️\\n\\nLa placa \"+PLACA+\" posee una temperatura de \"+Temp+\"ºC, superior al límite \"+flow.get(\"temp_max\")+\"ºC.\";\n \n return msg;\n}\nelse if (Temp < flow.get(\"temp_min\"))\n{\n    msg.payload.chatId = -1001705665908;\n    msg.payload.type = \"message\";\nmsg.payload.content= \"⚠️ TEMPERATURA POR DEBAJO DEL LÍMITE ⚠️\\n\\nLa placa \"+PLACA+\" posee una temperatura de \"+Temp+\"ºC, inferior al límite \"+flow.get(\"temp_min\")+\"ºC.\";\n\n    return msg;\n}\nelse if (Hum > flow.get(\"hum_max\"))\n{\n    msg.payload.chatId = -1001705665908;\n    msg.payload.type = \"message\";\nmsg.payload.content= \"⚠️ HUMEDAD POR ENCIMA DEL LÍMITE ⚠️\\n\\nLa placa \"+PLACA+\" posee una humedad del \"+Hum+\"%, superior al límite \"+flow.get(\"hum_max\")+\"º%.\";\n\n    return msg;\n}\nelse if (Hum < flow.get(\"hum_min\"))\n{\n    msg.payload.chatId = -1001705665908;\n    msg.payload.type = \"message\";\nmsg.payload.content= \"⚠️ HUMEDAD POR DEBAJO DEL LÍMITE ⚠️\\n\\nLa placa \"+PLACA+\" posee una humedad del \"+Hum+\"º% inferior al límite \"+flow.get(\"hum_min\")+\"%.\";\n\n    return msg;\n}\n}",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 4060,
        "y": 4120,
        "wires": [
            [
                "db65d201dee63c19"
            ]
        ]
    },
    {
        "id": "c486b2e778a81c7f",
        "type": "comment",
        "z": "d43d9cbcc461780f",
        "name": "Establece la placa con la que se opera",
        "info": "",
        "x": 3050,
        "y": 2200,
        "wires": []
    },
    {
        "id": "18c161679c77f6e3",
        "type": "comment",
        "z": "d43d9cbcc461780f",
        "name": "Consulta de sensores",
        "info": "",
        "x": 3020,
        "y": 2340,
        "wires": []
    },
    {
        "id": "b08ead5b57e97e44",
        "type": "comment",
        "z": "d43d9cbcc461780f",
        "name": "Consulta/Modificación de actuadores",
        "info": "",
        "x": 3030,
        "y": 2920,
        "wires": []
    },
    {
        "id": "ca27086f304bbffa",
        "type": "comment",
        "z": "d43d9cbcc461780f",
        "name": "Aviso al canal de modificación",
        "info": "",
        "x": 4040,
        "y": 3480,
        "wires": []
    },
    {
        "id": "ab3e4943aec93d4d",
        "type": "comment",
        "z": "d43d9cbcc461780f",
        "name": "Programación de una alarma",
        "info": "",
        "x": 3080,
        "y": 3720,
        "wires": []
    },
    {
        "id": "4e6155dd4d09f30f",
        "type": "telegram command",
        "z": "d43d9cbcc461780f",
        "name": "",
        "command": "/hmax",
        "description": "",
        "registercommand": false,
        "language": "",
        "scope": "default",
        "bot": "bba8b2693149435b",
        "strict": false,
        "hasresponse": true,
        "useregex": false,
        "removeregexcommand": false,
        "outputs": 2,
        "x": 3250,
        "y": 3940,
        "wires": [
            [
                "90ece9d48192bd8d"
            ],
            []
        ]
    },
    {
        "id": "909b1110208b904a",
        "type": "telegram command",
        "z": "d43d9cbcc461780f",
        "name": "",
        "command": "/hmin",
        "description": "",
        "registercommand": false,
        "language": "",
        "scope": "default",
        "bot": "bba8b2693149435b",
        "strict": false,
        "hasresponse": true,
        "useregex": false,
        "removeregexcommand": false,
        "outputs": 2,
        "x": 3250,
        "y": 3980,
        "wires": [
            [
                "9b4a8dc172a2f4f1"
            ],
            []
        ]
    },
    {
        "id": "90ece9d48192bd8d",
        "type": "function",
        "z": "d43d9cbcc461780f",
        "name": "Obtener valor hmax",
        "func": "var hum= parseInt(msg.payload.content);\nvar id = msg.payload.chatId;\nif ((msg.payload >= 0)&&(msg.payload <= 100))\n{\nmsg.payload = {};\n \n    msg.payload.hmax = hum;\n\n\nmsg.payload.chatId = id;\nreturn msg;\n}",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 3430,
        "y": 3940,
        "wires": [
            [
                "bcd445be46515225",
                "d1c745d1965ff89a"
            ]
        ]
    },
    {
        "id": "9b4a8dc172a2f4f1",
        "type": "function",
        "z": "d43d9cbcc461780f",
        "name": "Obtener valor hmin",
        "func": "var hum= parseFloat(msg.payload.content);\nvar id = msg.payload.chatId;\nif ((msg.payload >= 0)&&(msg.payload <= 100))\n{\nmsg.payload = {};\n\n    msg.payload.hmin = hum;\n\nmsg.payload.chatId = id;\nreturn msg;\n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 3430,
        "y": 3980,
        "wires": [
            [
                "09b5d3a60c0c94f6",
                "d1c745d1965ff89a"
            ]
        ]
    },
    {
        "id": "bcd445be46515225",
        "type": "change",
        "z": "d43d9cbcc461780f",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "hum_max",
                "pt": "flow",
                "to": "payload.hmax",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 3650,
        "y": 3940,
        "wires": [
            []
        ]
    },
    {
        "id": "09b5d3a60c0c94f6",
        "type": "change",
        "z": "d43d9cbcc461780f",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "hum_min",
                "pt": "flow",
                "to": "payload.hmin",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 3650,
        "y": 3980,
        "wires": [
            []
        ]
    },
    {
        "id": "ab327fe76cd1459c",
        "type": "ui_group",
        "name": "NIVEL LED",
        "tab": "d9498b661b4b97d4",
        "order": 1,
        "disp": true,
        "width": "6",
        "collapse": false,
        "className": ""
    },
    {
        "id": "819581010d48bfd0",
        "type": "mqtt-broker",
        "name": "",
        "broker": "iot.ac.uma.es",
        "port": "1883",
        "clientid": "",
        "usetls": false,
        "protocolVersion": "4",
        "keepalive": "60",
        "cleansession": true,
        "birthTopic": "",
        "birthQos": "0",
        "birthRetain": "false",
        "birthPayload": "",
        "birthMsg": {},
        "closeTopic": "",
        "closeQos": "0",
        "closeRetain": "false",
        "closePayload": "",
        "closeMsg": {},
        "willTopic": "",
        "willQos": "0",
        "willRetain": "false",
        "willPayload": "",
        "willMsg": {},
        "sessionExpiry": "",
        "credentials": {
            "user": "II1",
            "password": "7o56oYsu"
        }
    },
    {
        "id": "8c10952216336c2b",
        "type": "ui_group",
        "name": "CONFIG",
        "tab": "130b2bcfdd95d397",
        "order": 2,
        "disp": true,
        "width": "6",
        "collapse": false,
        "className": ""
    },
    {
        "id": "cc1d7259111dc549",
        "type": "ui_group",
        "name": "DATOS",
        "tab": "0252c3f076347a5b",
        "order": 1,
        "disp": true,
        "width": "6",
        "collapse": false,
        "className": ""
    },
    {
        "id": "8bc36ba409dbee33",
        "type": "ui_group",
        "name": "LED",
        "tab": "0252c3f076347a5b",
        "order": 2,
        "disp": true,
        "width": "6",
        "collapse": false,
        "className": ""
    },
    {
        "id": "a65ec6fec0e4c4fc",
        "type": "ui_group",
        "name": "ESP_10796726",
        "tab": "0252c3f076347a5b",
        "order": 3,
        "disp": true,
        "width": "6",
        "collapse": false,
        "className": ""
    },
    {
        "id": "5709fd4619421f28",
        "type": "ui_group",
        "name": "ESP_1128666",
        "tab": "0252c3f076347a5b",
        "order": 4,
        "disp": true,
        "width": "6",
        "collapse": false,
        "className": ""
    },
    {
        "id": "b7a35e9169b8724c",
        "type": "ui_group",
        "name": "NOTIFICACIONES",
        "tab": "130b2bcfdd95d397",
        "order": 2,
        "disp": true,
        "width": "6",
        "collapse": false,
        "className": ""
    },
    {
        "id": "1188649fe7bc9814",
        "type": "ui_group",
        "name": "SWITCH",
        "tab": "a4e89c3d44e0b978",
        "order": 2,
        "disp": true,
        "width": "6",
        "collapse": false,
        "className": ""
    },
    {
        "id": "3752afa1.deaf9",
        "type": "mongodb",
        "hostname": "iot.ac.uma.es",
        "topology": "direct",
        "connectOptions": "",
        "port": "27017",
        "db": "II1",
        "name": "",
        "credentials": {}
    },
    {
        "id": "0c8bf2f642261bd9",
        "type": "mqtt-broker",
        "name": "Proyecto",
        "broker": "iot.ac.uma.es",
        "port": "1883",
        "clientid": "",
        "usetls": false,
        "protocolVersion": "4",
        "keepalive": "60",
        "cleansession": true,
        "birthTopic": "",
        "birthQos": "0",
        "birthRetain": "false",
        "birthPayload": "",
        "birthMsg": {},
        "closeTopic": "",
        "closeQos": "0",
        "closeRetain": "false",
        "closePayload": "",
        "closeMsg": {},
        "willTopic": "",
        "willQos": "0",
        "willRetain": "false",
        "willPayload": "",
        "willMsg": {},
        "sessionExpiry": ""
    },
    {
        "id": "a34ffe7a.04009",
        "type": "ui_group",
        "name": "",
        "tab": "e63432e4.6c1e",
        "order": 1,
        "disp": true,
        "width": "13",
        "collapse": false,
        "className": ""
    },
    {
        "id": "bba8b2693149435b",
        "type": "telegram bot",
        "botname": "IIgrupo1_bot",
        "usernames": "",
        "chatids": "",
        "baseapiurl": "",
        "updatemode": "polling",
        "pollinterval": "300",
        "usesocks": false,
        "sockshost": "",
        "socksport": "6667",
        "socksusername": "anonymous",
        "sockspassword": "",
        "bothost": "",
        "botpath": "",
        "localbotport": "8443",
        "publicbotport": "8443",
        "privatekey": "",
        "certificate": "",
        "useselfsignedcertificate": false,
        "sslterminated": false,
        "verboselogging": false
    },
    {
        "id": "d33925125a47f633",
        "type": "mqtt-broker",
        "name": "iot.ac.uma.es",
        "broker": "iot.ac.uma.es",
        "port": "1883",
        "clientid": "",
        "usetls": false,
        "protocolVersion": "4",
        "keepalive": "60",
        "cleansession": true,
        "birthTopic": "",
        "birthQos": "0",
        "birthRetain": "false",
        "birthPayload": "",
        "birthMsg": {},
        "closeTopic": "",
        "closeQos": "0",
        "closeRetain": "false",
        "closePayload": "",
        "closeMsg": {},
        "willTopic": "",
        "willQos": "0",
        "willRetain": "false",
        "willPayload": "",
        "willMsg": {},
        "sessionExpiry": ""
    },
    {
        "id": "d9498b661b4b97d4",
        "type": "ui_tab",
        "name": "NIVEL LED",
        "icon": "dashboard",
        "disabled": false,
        "hidden": false
    },
    {
        "id": "130b2bcfdd95d397",
        "type": "ui_tab",
        "name": "CONFIG",
        "icon": "dashboard",
        "disabled": false,
        "hidden": false
    },
    {
        "id": "0252c3f076347a5b",
        "type": "ui_tab",
        "name": "ACTUALIZACION",
        "icon": "dashboard",
        "disabled": false,
        "hidden": false
    },
    {
        "id": "a4e89c3d44e0b978",
        "type": "ui_tab",
        "name": "ACTUADORES",
        "icon": "dashboard",
        "disabled": false,
        "hidden": false
    },
    {
        "id": "e63432e4.6c1e",
        "type": "ui_tab",
        "name": "Descarga de Datos",
        "icon": "dashboard",
        "order": 1,
        "disabled": false,
        "hidden": false
    }
]